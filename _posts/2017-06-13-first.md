---
layout: post
title:  first workign file
date:   2017-06-13 11:22:13 +1000
categories: jekyll update
assetfolder: first
#from
# ![png](output_17_0.png)
#to
#![png]({{site.baseurl}}/assets/{{post.assetfolder}}/output_17_0.png)

---



```python
import matplotlib
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import os
```


```python
%matplotlib inline
plt.rcParams['figure.figsize'] = (20, 10)
```

# RETRIEVING AND BASIC FORMATTING EXCEL FILES

## Retrieving the .xlsx files
Find the directory where the excel files are living. 

Then **'excel_files'** will report what lives inside the folder. 

Note: Any additional excel files you want analysed will need to be put into the same location as **'directory'.**


```python
directory = r"\\dc2-file001\Practice\InfoTech\BIM\Revit\RevitStandardsMasterBVN\02_BVN_Library\Master Content\X_Data\Data - ARR\_CONSOLIDATED v2"
files = os.listdir(directory)
excel_files = []
for f in files:
    if ".xlsx" in f:
        excel_files.append(f)
excel_files
```




    ['20170429 9_28 Family Types Log.xlsx',
     '20170429 9_28 FamilyCategory Log.xlsx',
     '20170429 9_28 FamilySubCategory Log.xlsx',
     '20170429 9_28 Host Families Log.xlsx',
     '20170429 9_28 Nested Families Log.xlsx',
     '20170429 9_28 OmniClass Log.xlsx',
     '20170429 9_28 Parameters Log.xlsx',
     '20170429 9_28 ParameterValuesByTypes Log.xlsx',
     '20170429 9_28 Reference Planes Log.xlsx',
     '20170429 9_28 Units Log.xlsx',
     '20170501 6_28 Materials Log.xlsx',
     '~$20170501 6_28 Materials Log.xlsx']



## xlsx. key and values

Use <b>keys</b> to pair each key with each excel file in <b>excel_files</b>. This is so that you don't have to type the long file name everytime you need to call it in the rest of the code. 

<b>file_dict</b> will tell you which excel file is paired with each key.


```python
keys = [
        "FamilyTypes",
        "FamilyCategory",
        "FamilySubCategory",
        "HostFamilies",
        "NestedFamilies",
        "OmniClass",
        "Parameters",
        "ParameterValuesByTypes",
        "ReferencePlanes",
        "Units",
        "Materials"
       ]

file_dict = {key: value for (key, value) in zip(keys, excel_files)}
file_dict
```




    {'FamilyCategory': '20170429 9_28 FamilyCategory Log.xlsx',
     'FamilySubCategory': '20170429 9_28 FamilySubCategory Log.xlsx',
     'FamilyTypes': '20170429 9_28 Family Types Log.xlsx',
     'HostFamilies': '20170429 9_28 Host Families Log.xlsx',
     'Materials': '20170501 6_28 Materials Log.xlsx',
     'NestedFamilies': '20170429 9_28 Nested Families Log.xlsx',
     'OmniClass': '20170429 9_28 OmniClass Log.xlsx',
     'ParameterValuesByTypes': '20170429 9_28 ParameterValuesByTypes Log.xlsx',
     'Parameters': '20170429 9_28 Parameters Log.xlsx',
     'ReferencePlanes': '20170429 9_28 Reference Planes Log.xlsx',
     'Units': '20170429 9_28 Units Log.xlsx'}



## FUNCTIONS TO FORMAT EXCEL FILES

### Removing the common file path characters from original family file path name

The example file path below is very long. In order to cut the fat out of the long file path, the common characters from each file path is removed. 

\\dc2-file001\Practice\InfoTech\BIM\Revit\RevitStandardsMasterBVN\02_BVN_Library\Master Content\Windows\Double Hung\Double Hung_3 Panel.rfa

Therefore, the start of the file path <b>\\dc2-file001\Practice\InfoTech\BIM\Revit\RevitStandardsMasterBVN\02_BVN_Library\Master Content</b> is removed in every spreadsheet.

### Removing the rfa. name from FamilyFilePath.

In the excel files, the family name (.rfa) is part of the FamilyFilePath column.

e.g. \\dc2-file001\Practice\InfoTech\BIM\Revit\RevitStandardsMasterBVN\02_BVN_Library\Master Content\Windows\Special\<u>Window Lancet_basic.rfa</u>

### Determines whether the family is an .rfa or from a .txt catalogue file.

<b> remove_rfaName</b> removes the family name from the FamilyFilePath column. This allows us to find things such as the count of how many families there are within a particular master content folder. It splits the <b>full_filepath</b> path by each \ .

<b>joined_again</b> will join the file path back through the \ except for the last one. The new file path is appended on a FamilyFilePath column.

### Determines whether the family is an .rfa or from a .txt catalogue file.
<b>getFileType</b> removes the last three characters from the FamilyFilePath.

<b>stripFileType</b> removes the last four characters (including the '.') from the FamilyName.


```python
commonPartofFilePath = len(r'\\dc2-file001\Practice\InfoTech\BIM\Revit\RevitStandardsMasterBVN\02_BVN_Library\Master Content')
print commonPartofFilePath
def stripCommonPath(row):
        return row.FamilyFilePath[commonPartofFilePath+1:]
    
def remove_rfaName(row):
    full_filepath = row.FamilyFilePath
    split = full_filepath.split("\\")[:-1]
    joined_again = ("\\".join(split))
    return  joined_again

def getFileType(row):
    return row.FamilyFilePath[-3:]

def stripFileType(row):
    return row.FamilyName[:-4]
```

    95
    

# FAMILY CATEGORIES

<b>fc_path</b> and <b>fc</b> reads the data from the Family Categories excel file


```python
fc_path = os.path.join(directory, file_dict["FamilyCategory"])
fc = pd.read_excel(fc_path)

fc["FamilyFilePath"] = fc.apply(remove_rfaName, axis=1)
fc["FamilyFilePath"] = fc.apply(stripCommonPath, axis=1)
fc.head()
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FamilyFilePath</th>
      <th>FamilyName</th>
      <th>Category</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN.rfa</td>
      <td>Windows</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Windows\Structural</td>
      <td>Window_Round Opening_WIN.rfa</td>
      <td>Windows</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Windows\Special</td>
      <td>Window Round_basic.rfa</td>
      <td>Windows</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Windows\Special</td>
      <td>Window Lancet_basic.rfa</td>
      <td>Windows</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Windows\Special</td>
      <td>Window Arched Top_basic.rfa</td>
      <td>Windows</td>
    </tr>
  </tbody>
</table>
</div>



## No. of families in a Category

<b> fc_counts</b> will count the number of families there are in a category.

Note: This reported count will only be accurate if there is only one instance of the family in the FamilyName.


```python
fc_counts = fc["Category"].value_counts()
```


```python
fc_counts.plot(kind="bar", fontsize = 8);
plt.title ("Number of Families in a Category", fontsize=20)
plt.xlabel("Category Name", fontsize = 15)
plt.ylabel("Number of Families", fontsize = 15)
plt.show()
```


![png]({{site.baseurl}}/assets/{{post.nickname}}/output_17_0.png)


## No. of families in a Category (Highest Offenders)

Use <b>cutoff</b> to filter the graph based on the number of families there are in a category.

e.g. cutoff > 15


```python
cutoff = 15

fc_counts[fc_counts>cutoff].plot(kind="bar");
plt.title ("Number of Families in a Category (Worst Offenders)", fontsize=20)
plt.xlabel("Category Name", fontsize=15)
plt.ylabel("Number of Families", fontsize=15)
plt.show()
```


![png]({{site.baseurl}}/assets/first/output_19_0.png)


## Filter and List No. of families in a Category

Use <b>fc_counts</b> to filter and list any high or low offenders.


```python
fc_counts[fc_counts <= 2]
```




    Roof Tags                               2
    Revision Cloud Tags                     2
    Door Tags                               2
    Data Devices                            2
    Structural Area Reinforcement Tags      2
    Area Load Tags                          2
    Planting Tags                           2
    Conduit Fitting Tags                    2
    Internal Line Load Tags                 2
    Casework Tags                           2
    Assembly Tags                           2
    Lighting Device Tags                    2
    Railing Tags                            2
    Cable Tray Fitting Tags                 2
    Wire Tags                               2
    Structural Rebar Tags                   2
    Structural Fabric Reinforcement Tags    2
    Supports                                2
    Data Device Tags                        2
    Point Load Tags                         2
    Nurse Call Device Tags                  2
    Duct Fitting Tags                       2
    Structural Truss Tags                   2
    Telephone Device Tags                   2
    Sprinkler Tags                          2
    Communication Device Tags               2
    Stair Support Tags                      2
    Part Tags                               2
    Mass Floor Tags                         2
    Stair Tags                              2
    Pipe Fitting Tags                       2
    Line Load Tags                          2
    Furniture System Tags                   2
    Mass Tags                               2
    Internal Area Load Tags                 2
    Fire Alarm Device Tags                  2
    Stair Run Tags                          2
    Curtain Panel Tags                      2
    Structural Path Reinforcement Tags      2
    Internal Point Load Tags                2
    Furniture Tags                          2
    Security Device Tags                    2
    Zone Tags                               2
    Air Terminal Tags                       2
    Terminations                            1
    Span Direction Symbol                   1
    Name: Category, dtype: int64



# FAMILIES IN FOLDERS

## No. of families in each folder

Note: This includes subfolders

<b>folder_counts</b> will count the number of families there are in a folder.


```python
folder_counts = fc["FamilyFilePath"].value_counts()
```


```python
folder_counts.plot(kind="bar", grid=True, fontsize = 8);
plt.title ("No. of Families in each folder within Master Content", fontsize=20)
plt.xlabel("Folder File Path (including subfolders)", fontsize = 15)
plt.ylabel("Number of Families", fontsize = 15)
plt.show()
```


![png]({{site.baseurl}}/assets/first/output_24_0.png)


## No. of families in each folder (Worst Offenders)

Use <b>cutoff</b> to filter the graph based on the number of families there are in each folder in the master content.

e.g. cutoff > 15


```python
cutoff = 5

folder_counts[folder_counts<cutoff].plot(kind="bar", grid=True);
plt.title ("No. of Families in each folder within Master Content (Worst Offenders)", fontsize=20)
plt.xlabel("Category Name", fontsize=15)
plt.ylabel("Number of Families", fontsize=15)
plt.show()
```


![png]({{site.baseurl}}/assets/first/output_26_0.png)


# FAMILY TYPES

<b>ft</b> and <b>ft_path</b> reads from the Family Types excel file.


```python
ft_path = os.path.join(directory, file_dict["FamilyTypes"])
ft = pd.read_excel(ft_path)

ft["fileType"] = ft.apply(getFileType, axis=1)
ft["FamilyName"] = ft.apply(stripFileType, axis=1)
ft["FamilyFilePath"] = ft.apply(remove_rfaName, axis=1)
ft["FamilyFilePath"] = ft.apply(stripCommonPath, axis=1)

ft.head()
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FamilyFilePath</th>
      <th>FamilyName</th>
      <th>FamilyTypeName</th>
      <th>fileType</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Windows\Special</td>
      <td>Window Round_basic</td>
      <td></td>
      <td>rfa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Windows\Special</td>
      <td>Window Lancet_basic</td>
      <td></td>
      <td>rfa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Windows\Special</td>
      <td>Window Arched Top_basic</td>
      <td></td>
      <td>rfa</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Windows\Special</td>
      <td>Skylight_Velux_FCM_WIN</td>
      <td></td>
      <td>rfa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Windows\Special</td>
      <td>Skylight_Operable_WIN</td>
      <td>600 x 600mm</td>
      <td>rfa</td>
    </tr>
  </tbody>
</table>
</div>



## No. of Family Types

<b>ft_counts</b> will count the number of family types there are for each family.


```python
ft_counts = ft.FamilyName.value_counts()
```


```python
plt.hist(ft_counts, bins=20)
plt.title("Number of Family Types across Master Content", fontsize=20)
plt.xlabel("Number of Family Types", fontsize=15)
plt.ylabel("Number of Families", fontsize=15)
plt.show()
```


![png]({{site.baseurl}}/assets/first/output_31_0.png)


## No. of Family Types (Highest Offenders)

Use <b>cutoff</b> to filter the graph based on the number of families there are in a category.

e.g. cutoff > 50


```python
cutoff = 50

plt.hist(ft_counts[ft_counts>cutoff])
plt.title("Number of Family Types across Master Content (Over 50 Family Types)", fontsize=20)
plt.xlabel("Number of Family Types", fontsize=15)
plt.ylabel("Number of Families", fontsize=15)
plt.show()
```


![png]({{site.baseurl}}/assets/first/output_33_0.png)


## Families with 50+ family types


```python
ft_counts[ft_counts>50]
```




    Supply Diffuser_Sidewall                             529
    HSS_Hollow Structural Section_Pro                    333
    CISC Wide Flange Shapes_Side                         294
    CISC Wide Flange Shapes_Section                      294
    CISC Wide Flange Shapes_Top                          294
    W_Wide Flange                                        274
    W_Wide Flange_Pro                                    267
    WT_Structural Tee_Pro                                267
    WT_Structural Tee                                    267
    Table_HermanMiller_DU6ACS_RectangularTable_C_Foot    192
    CISC WT Shapes_Top                                   190
    CISC WT Shapes_Section                               190
    CISC WT Shapes_Side                                  190
    Table_HermanMiller_DU6ATS_RectangularTable_T_Foot    180
    VAV Outlet Plenum_Wye                                153
    VAV Outlet Plenum_Elbow                              153
    Louvre_Extruded_200 mm Pitch                         150
    Plate                                                142
    CISC Tube Shapes_Section                             126
    CISC Tube Shapes_Top                                 126
    CISC Tube Shapes_Side                                126
    Linear Stiffener_Angle                               125
    L_Angle_Pro                                          125
    Flat Bar                                             116
    FB_Flat Bar_Column                                   116
    FB_Flat Bar_Framing                                  116
    SHS_Square Hollow Section                            115
    SHS_Square Hollow Section_Framing                    115
    SHS_Square Hollow Section_Column                     115
    CHS_Circular Hollow Section_Framing                  113
    CHS_Circular Hollow Section                          113
    CHS_Circular Hollow Section_Column                   113
    Table_HermanMiller_DU6DTS_OvalTable_T_Foot           108
    CISC Angle Shapes_Section                            106
    CISC Angle Shapes_Side                               106
    CISC Angle Shapes_Top                                106
    RHS_Rectangular Hollow Section                       100
    RHS_Rectangular Hollow Section_Column                100
    RHS_Rectangular Hollow Section_Framing               100
    VAV Outlet Plenum_Cross                               85
    VAV Outlet Plenum_Tee                                 85
    VAV Outlet Plenum_Double Wye                          85
    Timber Stud_Section                                   80
    Timber Stud_Section_DCO                               80
    LH_Series Bar Joist                                   80
    Swing_Single_DOR -                                    78
    Swing_Single                                          78
    UB_Universal Beam_Pro                                 73
    Weights equipment_SEQ                                 67
    K_Series Bar Joist_Angle Web                          64
    K_Series Bar Joist_Rod Web                            64
    UBT - Structural Tee - Section (AUS)                  64
    CISC HS Pipe Shapes_Section                           63
    CISC HS Pipe Shapes_Side                              63
    CISC HS Pipe Shapes_Top                               63
    COM_Host_WI                                           60
    Timber_Column                                         56
    Timber                                                56
    Name: FamilyName, dtype: int64



## Families with 500+ family types?

The high count of family types means that these families have a Revit catalogue file attached to it. 

The code below differentiates the .txt catalogue files from the .rfa files.

## .rfa vs .txt Family Types 

### Filtering for .txt files

<b>ft_hasTxt</b> filters for family types that are from txt catalog files.


```python
ft_hasTxt = ft[ft.fileType=="txt"]
ft_hasTxt.head()
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FamilyFilePath</th>
      <th>FamilyName</th>
      <th>FamilyTypeName</th>
      <th>fileType</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>156</th>
      <td>Windows\Double Hung</td>
      <td>Double Hung_3LT</td>
      <td>1816</td>
      <td>txt</td>
    </tr>
    <tr>
      <th>157</th>
      <td>Windows\Double Hung</td>
      <td>Double Hung_3LT</td>
      <td>1818</td>
      <td>txt</td>
    </tr>
    <tr>
      <th>158</th>
      <td>Windows\Double Hung</td>
      <td>Double Hung_3LT</td>
      <td>1822</td>
      <td>txt</td>
    </tr>
    <tr>
      <th>159</th>
      <td>Windows\Double Hung</td>
      <td>Double Hung_3LT</td>
      <td>1824</td>
      <td>txt</td>
    </tr>
    <tr>
      <th>160</th>
      <td>Windows\Double Hung</td>
      <td>Double Hung_3LT</td>
      <td>1828</td>
      <td>txt</td>
    </tr>
  </tbody>
</table>
</div>



### Filtering for .rfa files

<b>ft_noTxt</b> filters for family types that are from within the Revit family.


```python
ft_noTxt = ft[ft.fileType=="rfa"]
ft_noTxt.head(10)
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FamilyFilePath</th>
      <th>FamilyName</th>
      <th>FamilyTypeName</th>
      <th>fileType</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Windows\Special</td>
      <td>Window Round_basic</td>
      <td></td>
      <td>rfa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Windows\Special</td>
      <td>Window Lancet_basic</td>
      <td></td>
      <td>rfa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Windows\Special</td>
      <td>Window Arched Top_basic</td>
      <td></td>
      <td>rfa</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Windows\Special</td>
      <td>Skylight_Velux_FCM_WIN</td>
      <td></td>
      <td>rfa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Windows\Special</td>
      <td>Skylight_Operable_WIN</td>
      <td>600 x 600mm</td>
      <td>rfa</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Windows\Special</td>
      <td>Skylight_Operable_WIN</td>
      <td>900 x 600mm</td>
      <td>rfa</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Windows\Special</td>
      <td>Skylight_Operable_WIN</td>
      <td>900 x 900mm</td>
      <td>rfa</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Windows\Special</td>
      <td>Round with Trim_WIN</td>
      <td>0610 mm Diameter</td>
      <td>rfa</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Windows\Special</td>
      <td>Round with Trim_WIN</td>
      <td>0915mm Diameter</td>
      <td>rfa</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Windows\Special</td>
      <td>Round with Trim_WIN</td>
      <td>1220mm Diameter</td>
      <td>rfa</td>
    </tr>
  </tbody>
</table>
</div>



### No. of .txt vs .rfa family types

<b>fileType_counts</b> counts the number of .rfa vs .txt family types.


```python
fileType_counts = ft.fileType.value_counts()
```


```python
fileType_counts.plot(kind="bar", grid=True, fontsize=15)
plt.title("Number of Family Types (.rfa vs .txt)", fontsize=20)
plt.xlabel("File Type", fontsize=15)
plt.ylabel("Number of family types", fontsize=15)
plt.show()
```


![png]({{site.baseurl}}/assets/first/output_43_0.png)


### No. of Family Types for native .rfa families

<b>rfaType_counts</b> counts the number of family types within the native rfa family.


```python
rfaType_counts = ft_noTxt[["FamilyName","FamilyTypeName"]].groupby("FamilyName").agg("count")

rfaType_counts.head()
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FamilyTypeName</th>
    </tr>
    <tr>
      <th>FamilyName</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1 Bay Window</th>
      <td>2</td>
    </tr>
    <tr>
      <th>1 Bay Window - Non Hosted</th>
      <td>1</td>
    </tr>
    <tr>
      <th>10P_Perimeter_Bench_FYS</th>
      <td>1</td>
    </tr>
    <tr>
      <th>115_BVNDH_WC Cubicle</th>
      <td>3</td>
    </tr>
    <tr>
      <th>12P_Meeting_FYS</th>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>




```python
rfaType_counts.hist(bins=100)
plt.title("Number of Family Types for .rfa families", fontsize=20)
plt.xlabel("Number of Family Types", fontsize=15)
plt.ylabel("Number of Families", fontsize=15)
```




    <matplotlib.text.Text at 0xe8ceba8>




![png]({{site.baseurl}}/assets/first/output_46_1.png)


### No. of Family Types for native .rfa families (Worst Offenders)


```python
rfaType_counts[rfaType_counts.FamilyTypeName>50]
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FamilyTypeName</th>
    </tr>
    <tr>
      <th>FamilyName</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Timber Stud_Section_DCO</th>
      <td>80</td>
    </tr>
    <tr>
      <th>Weights equipment_SEQ</th>
      <td>67</td>
    </tr>
  </tbody>
</table>
</div>



### No. of Family Types from .txt files


```python
txtType_counts = ft_hasTxt[["FamilyName","FamilyTypeName"]].groupby("FamilyName").agg("count")
```


```python
txtType_counts.hist(bins=100)
plt.title("Number of Family Types for families with .txt files", fontsize=20)
plt.xlabel("Number of Family Types", fontsize=15)
plt.ylabel("Number of Families", fontsize=15)
plt.show()
```


![png]({{site.baseurl}}/assets/first/output_51_0.png)


### No. of Family Types from .txt files > 200


```python
txtType_counts[txtType_counts.FamilyTypeName>200]
```

### ***REVISIT***


```python
def has_txt_catalogue(row):
    """Checks to see if theres a txt file corresponding to this family
    
    Very slow, needs work at some point
    """
    return ft[(ft.fileType=="txt") & (ft.FamilyName==row.FamilyName)].shape[0]

ft_noTxt["catalogueSize"] = ft_noTxt.apply(has_txt_catalogue, axis=1)
ft_noTxt.head()
```

    Q:\Users\arivera\AppData\Local\Continuum\Anaconda2\lib\site-packages\ipykernel\__main__.py:8: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead
    
    See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
    




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FamilyFilePath</th>
      <th>FamilyName</th>
      <th>FamilyTypeName</th>
      <th>fileType</th>
      <th>catalogueSize</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Windows\Special</td>
      <td>Window Round_basic</td>
      <td></td>
      <td>rfa</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Windows\Special</td>
      <td>Window Lancet_basic</td>
      <td></td>
      <td>rfa</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Windows\Special</td>
      <td>Window Arched Top_basic</td>
      <td></td>
      <td>rfa</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Windows\Special</td>
      <td>Skylight_Velux_FCM_WIN</td>
      <td></td>
      <td>rfa</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Windows\Special</td>
      <td>Skylight_Operable_WIN</td>
      <td>600 x 600mm</td>
      <td>rfa</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




```python
ft_noTxt.shape
```




    (10436, 5)



# FAMILY SUBCATEGORIES

<b>fs_path</b> and <b>fs</b> reads the data from the Family Subcategories excel file.

<b>NOTE:</b> The columns - LinePatternName, LineWeight_Projection, LineWeight_Cut are dropped from the dataframe.


```python
fs_path = os.path.join(directory, file_dict["FamilySubCategory"])
fs = pd.read_excel(fs_path)

fs["FamilyFilePath"] = fs.apply(remove_rfaName, axis=1)
fs["FamilyFilePath"] = fs.apply(stripCommonPath, axis=1)
fs["FamilyName"] = fs.apply(stripFileType, axis=1)

fs.drop(["LinePatternName", "LineWeight_Projection", "LineWeight_Cut"],axis=1, inplace=True)

fs.head()
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FamilyFilePath</th>
      <th>FamilyName</th>
      <th>Category</th>
      <th>Subcategory</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Windows</td>
      <td>Frame/Mullion</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Windows</td>
      <td>Glass</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Windows</td>
      <td>Opening</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Windows</td>
      <td>Overhead</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Windows</td>
      <td>Opening Elevation</td>
    </tr>
  </tbody>
</table>
</div>



## Number of subcategories of families

<b>fs_counts</b> and <b>grouped_subcat</b> counts the number of subcategories there are within each family.


```python
fs_counts = fs["Subcategory"].value_counts()
```


```python
grouped_subcat = fs.groupby("FamilyName").agg(['count'])

grouped_subcat["Subcategory"].hist(bins=50);
plt.title("Number of subcategories of families", fontsize=20)
plt.xlabel("Number of subcategories", fontsize=15)
plt.ylabel("Number of families", fontsize=15)
plt.show()
```


![png]({{site.baseurl}}/assets/first/output_61_0.png)


## Most used subcategories > 100


```python
fs_counts[fs_counts>100]
```




    Hidden Lines             4083
    Medium Lines              607
    Light Lines               546
    Glass                     529
    Heavy Lines               480
    Opening                   443
    Frame/Mullion             428
    Center line               382
    Panel                     272
    Taps/Mixers               266
    Waste Outlets             232
    Penetration               231
    Clearance Zones           228
    FHRs/Hydrants             226
    Fire Boosters/Pumps       224
    Baths/Showers             222
    Basins/Sinks/Tubs         221
    Hardware                  216
    Urinals                   216
    Elevation Swing           189
    Toilet/Bidets             178
    Sill/Head                 166
    Plan Swing                164
    Seating_Freestanding      164
    Swing_Elevation           161
    Shower Fall               154
    Swing_Plan                150
    Circulation Space         141
    Gas Supply Fixtures       140
    Gas Cooking Equipment     140
    Rigid Links               132
    Location Lines            132
    Thin Lines                110
    Hidden Faces              107
    Fittings                  101
    Name: Subcategory, dtype: int64



## Least used subcategories < 100


```python
fs_counts[fs_counts<100]
```




    Light Source                            92
    Architrave/Trim                         92
    Property Line Segments                  91
    Property Lines                          91
    Survey Point                            91
    Project Base Point                      91
    Pads                                    91
    Stick Symbols                           85
    Wide Lines                              84
    Plan rep_Leaf_Thicknessâ€‹              78
    Thresholds                              77
    Plan rep_Leaf_Single line               76
    Shelving                                74
    Grab Rails                              70
    Downpipes                               68
    Glazing - Aluminium                     68
    Door Swing                              67
    Elevation_Swingâ€‹                      66
    Toilets/Bidets                          65
    Structural Opening                      63
    Elevation_Linework_Shelving             59
    Carcass                                 59
    Hardware_Setout reference               59
    Section_Linework_Shelf hole             59
    Door/Drawer Leaf                        59
    Elevation_Linework_Swing                59
    Elevation_Linework_Carcass thickness    59
    End Panel                               59
    Appliance_Fixed                         56
    Thickest Lines                          55
                                            ..
    Futsal Court Size Range                  1
    Sprinkler - Pump House                   1
    CW100                                    1
    F100                                     1
    Handrail                                 1
    Toilet                                   1
    Stationary                               1
    Detail Component - Callout Boundary      1
    WarningMessage                           1
    FORMAT                                   1
    Penetration_Elevation_Linework           1
    Netball Court                            1
    Starting Blocks                          1
    Linee medie                              1
    Fire Hose Reel                           1
    Awning FC Plan                           1
    Over Head                                1
    Stripe                                   1
    Chain Gate                               1
    ZEE Sextion                              1
    LINE5                                    1
    Caster                                   1
    AFL Field                                1
    TITLE                                    1
    Futsal Court                             1
    Awning Frame                             1
    Grate Drain                              1
    AM_0N                                    1
    z2D                                      1
    HIDDEN                                   1
    Name: Subcategory, dtype: int64



## No. of subcategories  (Worst Offenders)


```python
sub_counts = grouped_subcat["Subcategory"]
sub_counts[sub_counts["count"]>20]
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
    </tr>
    <tr>
      <th>FamilyName</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Articulated Vehicle_SIT</th>
      <td>24</td>
    </tr>
    <tr>
      <th>BVN-Casework - ALL - FAMILY</th>
      <td>23</td>
    </tr>
    <tr>
      <th>Car And Trailer_SIT</th>
      <td>24</td>
    </tr>
    <tr>
      <th>DCW_Door_Glass Sliding Double</th>
      <td>21</td>
    </tr>
    <tr>
      <th>Drainage_Roof Drain 100mm_DCO</th>
      <td>56</td>
    </tr>
    <tr>
      <th>Drainage_Roof Drain 150mm_DCO</th>
      <td>56</td>
    </tr>
    <tr>
      <th>Drainage_Roof Drain 200mm_DCO</th>
      <td>56</td>
    </tr>
    <tr>
      <th>Drainage_Roof Drain_DCO</th>
      <td>56</td>
    </tr>
    <tr>
      <th>Exit_Fire Directional Sign Arrow</th>
      <td>21</td>
    </tr>
    <tr>
      <th>Fire Extinguisher_Wall Based_PLU</th>
      <td>22</td>
    </tr>
    <tr>
      <th>Graphic Scale 1_050_BL Justified_Grey_ANN</th>
      <td>21</td>
    </tr>
    <tr>
      <th>Graphic Scale 1_1000_BL Justified_Grey_ANN</th>
      <td>21</td>
    </tr>
    <tr>
      <th>Graphic Scale 1_100_BL Justified_Grey_ANN</th>
      <td>21</td>
    </tr>
    <tr>
      <th>Graphic Scale 1_2000_BL Justified_Grey_ANN</th>
      <td>21</td>
    </tr>
    <tr>
      <th>Graphic Scale 1_200_BL Justified_Grey_ANN</th>
      <td>21</td>
    </tr>
    <tr>
      <th>Graphic Scale 1_2500_BL Justified_Grey_ANN</th>
      <td>21</td>
    </tr>
    <tr>
      <th>Graphic Scale 1_250_BL Justified_Grey_ANN</th>
      <td>21</td>
    </tr>
    <tr>
      <th>Graphic Scale 1_500_BL Justified_Grey_ANN</th>
      <td>21</td>
    </tr>
    <tr>
      <th>KOP_Shower_Standard Suite_PLU</th>
      <td>21</td>
    </tr>
    <tr>
      <th>KOP_WC_Ambulant Suite_PLU</th>
      <td>22</td>
    </tr>
    <tr>
      <th>KOP_WC_PWD Suite_PLU</th>
      <td>25</td>
    </tr>
    <tr>
      <th>Penetration_DCO</th>
      <td>21</td>
    </tr>
    <tr>
      <th>Small Rigid Vehicle_SIT</th>
      <td>24</td>
    </tr>
    <tr>
      <th>Swing_Double_DOR</th>
      <td>44</td>
    </tr>
    <tr>
      <th>Swing_Single_DOR</th>
      <td>44</td>
    </tr>
    <tr>
      <th>Van_SIT</th>
      <td>24</td>
    </tr>
    <tr>
      <th>WC_Ambulant_Wall Mounted Cistern_PLU</th>
      <td>21</td>
    </tr>
    <tr>
      <th>WC_In Wall Cistern_Caroma_Cube_Wall Hung_PLU</th>
      <td>24</td>
    </tr>
    <tr>
      <th>WC_In Wall Cistern_Caroma_Geo_PLU</th>
      <td>24</td>
    </tr>
    <tr>
      <th>WC_In Wall Cistern_Caroma_Leda_PLU</th>
      <td>24</td>
    </tr>
    <tr>
      <th>WC_In Wall Cistern_Caroma_Metro_PLU</th>
      <td>24</td>
    </tr>
    <tr>
      <th>WC_In Wall Cistern_Caroma_Metro_Wall Hung_PLU</th>
      <td>24</td>
    </tr>
    <tr>
      <th>WC_PWD_Wall Mounted Cistern_PLU</th>
      <td>21</td>
    </tr>
    <tr>
      <th>WC_Wall Mounted Cistern_Caroma_Caravelle_PLU</th>
      <td>24</td>
    </tr>
    <tr>
      <th>WC_Wall Mounted Cistern_Caroma_Care 800_PLU</th>
      <td>21</td>
    </tr>
    <tr>
      <th>WC_Wall Mounted Cistern_Caroma_Regal II_PLU</th>
      <td>24</td>
    </tr>
  </tbody>
</table>
</div>



## BVN vs non BVN Subcats

### Checks to see whether family subcategory is part of the BVN list

<b>fs_BVN</b> is a list of the BVN subcategories.

<b>is_legit</b> checks to see if the values in the Subcategories column are a part of the <b>fs_BVN</b> list and adds to the table.


```python
fs_BVN = ['AV ', 'Air Handling units', 'Alarms/Sensors', 'Appliance_Fixed', 'Appliance_Freestanding', 'Appliances', 'Architrave/Trim', 'Audio Equipment', 'Balusters', 'Basins/Sinks/Tubs', 'Baths/Showers', 'Bedding', 'Bike Racks', 'Boilers', 'Cabinets/Panels', 'Carcass/Framing', 'Center line', 'Chilled Water Sets', 'Chillers', 'Chilling Beams', 'Chord', 'Clearance Zones', 'Common Edges', 'Common edges', 'Condensing Units', 'Contour', 'Conveyor Systems', 'Cooling Towers', 'Counter Tops', 'Display Boards', 'Downpipes', 'Downpipes overhead', 'Drawers/Dressers', 'Drop', 'Extraction Systems', 'FHRs/Hydrants ', 'Fans', 'Fire Boosters/Pumps', 'Form', 'Frame', 'Frame/Mullion', 'General Purpose Outlets', 'Girder', 'Glass', 'Grab Rails', 'Graphics', 'Gridlines', 'Ground Cover', 'Hard Landscaping', 'Hardware', 'Hardware_PWD', 'Heaters', 'Hidden Faces', 'Hidden Lines', 'Hidden Lines OH', 'Hidden Lines UB', 'Horizontal Bracing', 'IT', 'Joist', 'Kicker Bracing', 'Light Lines', 'Light Source', 'Lighter Lines', 'Lightest lines', 'Lighting', 'Mass Exterior Wall', 'Mass Floor', 'Mass Glazing', 'Mass Interior Wall', 'Mass Opening', 'Mass Roof', 'Mass Shade', 'Mass Skylight', 'Mass Zone', 'Medium Lines', 'Moulding/Muntins', 'Nodes', 'Opening', 'Other', 'Outdoor Furniture', 'Pads', 'Panel', 'Parking Layout', 'Partitions', 'Pattern', 'Pattern Fill', 'Pattern Lines', 'Pedestals', 'Penetration', 'People', 'Plinths', 'Primary Contours', 'Property Lines', 'Purlin', 'Railings Beyond Cut Line', 'Rails', 'Reveal', 'Rigid Links', 'Rise', 'Sash', 'Sealant', 'Seating_Fixed', 'Seating_Freestanding', 'Secondary Contours', 'Security Equipment', 'Shelving', 'Shelving_Fixed', 'Shelving_Freestanding', 'Signage', 'Sill/Head', 'Sill_Wall', 'Site Furniture', 'Site Scrape Contour', 'Speakers', 'Stick Symbols', 'Storage', 'Structural Opening', 'Sundries', 'Sweep_Cornice', 'Sweep_Skirting', 'Swing_ Elevation', 'Swing_ Plan', 'Swing_Elevation', 'Swing_Plan', 'Switchboards', 'Switches', 'Tables_Fixed', 'Tables_Freestanding', 'Taps/Mixers', 'Thick Lines', 'Thicker Lines', 'Thickest Lines', 'Thresholds', 'Toilets/Bidets', 'Transportation Equipment', 'Trees/Shrubs', 'Triangulation Edges', 'Urinals', 'Utilities', 'Variable Air Volume Terminals', 'Vehicles', 'Vertical Bracing', 'Waste outlets', 'Water Storage', 'Way Finding', 'Web', 'Wheelstops', 'Workstations/Desks']

def is_legit(row):
    return row.Subcategory in fs_BVN

fs["BVNsubcat"] = fs.apply(is_legit, axis=1)

fs.head(100)
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FamilyFilePath</th>
      <th>FamilyName</th>
      <th>Category</th>
      <th>Subcategory</th>
      <th>BVNsubcat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Windows</td>
      <td>Frame/Mullion</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Windows</td>
      <td>Glass</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Windows</td>
      <td>Opening</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Windows</td>
      <td>Overhead</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Windows</td>
      <td>Opening Elevation</td>
      <td>False</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Windows</td>
      <td>Sill/Head</td>
      <td>True</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Windows</td>
      <td>Hidden Lines</td>
      <td>True</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Windows\Structural</td>
      <td>Window_Round Opening_WIN</td>
      <td>Windows</td>
      <td>Frame/Mullion</td>
      <td>True</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Windows\Structural</td>
      <td>Window_Round Opening_WIN</td>
      <td>Windows</td>
      <td>Glass</td>
      <td>True</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Windows\Structural</td>
      <td>Window_Round Opening_WIN</td>
      <td>Windows</td>
      <td>Opening</td>
      <td>True</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Windows\Structural</td>
      <td>Window_Round Opening_WIN</td>
      <td>Windows</td>
      <td>Overhead</td>
      <td>False</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Windows\Structural</td>
      <td>Window_Round Opening_WIN</td>
      <td>Windows</td>
      <td>Opening Elevation</td>
      <td>False</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Windows\Structural</td>
      <td>Window_Round Opening_WIN</td>
      <td>Windows</td>
      <td>Sill/Head</td>
      <td>True</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Windows\Structural</td>
      <td>Window_Round Opening_WIN</td>
      <td>Windows</td>
      <td>Hidden Lines</td>
      <td>True</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Windows\Special</td>
      <td>Window Round_basic</td>
      <td>Windows</td>
      <td>Trim</td>
      <td>False</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Windows\Special</td>
      <td>Window Round_basic</td>
      <td>Windows</td>
      <td>Frame/Mullion</td>
      <td>True</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Windows\Special</td>
      <td>Window Round_basic</td>
      <td>Windows</td>
      <td>Glass</td>
      <td>True</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Windows\Special</td>
      <td>Window Round_basic</td>
      <td>Windows</td>
      <td>Opening</td>
      <td>True</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Windows\Special</td>
      <td>Window Round_basic</td>
      <td>Windows</td>
      <td>Elevation Swing</td>
      <td>False</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Windows\Special</td>
      <td>Window Round_basic</td>
      <td>Windows</td>
      <td>Sill/Head</td>
      <td>True</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Windows\Special</td>
      <td>Window Round_basic</td>
      <td>Windows</td>
      <td>Hidden Lines</td>
      <td>True</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Windows\Special</td>
      <td>Window Round_basic</td>
      <td>Windows</td>
      <td>Plan Swing</td>
      <td>False</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Windows\Special</td>
      <td>Window Lancet_basic</td>
      <td>Windows</td>
      <td>Trim</td>
      <td>False</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Windows\Special</td>
      <td>Window Lancet_basic</td>
      <td>Windows</td>
      <td>Frame/Mullion</td>
      <td>True</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Windows\Special</td>
      <td>Window Lancet_basic</td>
      <td>Windows</td>
      <td>Glass</td>
      <td>True</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Windows\Special</td>
      <td>Window Lancet_basic</td>
      <td>Windows</td>
      <td>Opening</td>
      <td>True</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Windows\Special</td>
      <td>Window Lancet_basic</td>
      <td>Windows</td>
      <td>Elevation Swing</td>
      <td>False</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Windows\Special</td>
      <td>Window Lancet_basic</td>
      <td>Windows</td>
      <td>Sill/Head</td>
      <td>True</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Windows\Special</td>
      <td>Window Lancet_basic</td>
      <td>Windows</td>
      <td>Hidden Lines</td>
      <td>True</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Windows\Special</td>
      <td>Window Lancet_basic</td>
      <td>Windows</td>
      <td>Plan Swing</td>
      <td>False</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>70</th>
      <td>Windows\Special</td>
      <td>Hopper with Trim_WIN</td>
      <td>Windows</td>
      <td>Elevation Swing</td>
      <td>False</td>
    </tr>
    <tr>
      <th>71</th>
      <td>Windows\Special</td>
      <td>Hopper with Trim_WIN</td>
      <td>Windows</td>
      <td>Sill/Head</td>
      <td>True</td>
    </tr>
    <tr>
      <th>72</th>
      <td>Windows\Special</td>
      <td>Hopper with Trim_WIN</td>
      <td>Windows</td>
      <td>Hidden Lines</td>
      <td>True</td>
    </tr>
    <tr>
      <th>73</th>
      <td>Windows\Special</td>
      <td>Hopper with Trim_WIN</td>
      <td>Windows</td>
      <td>Plan Swing</td>
      <td>False</td>
    </tr>
    <tr>
      <th>74</th>
      <td>Windows\Special</td>
      <td>Face Based Fixed Window for Angled Hosts</td>
      <td>Windows</td>
      <td>Frame/Mullion</td>
      <td>True</td>
    </tr>
    <tr>
      <th>75</th>
      <td>Windows\Special</td>
      <td>Face Based Fixed Window for Angled Hosts</td>
      <td>Windows</td>
      <td>Glass</td>
      <td>True</td>
    </tr>
    <tr>
      <th>76</th>
      <td>Windows\Special</td>
      <td>Face Based Fixed Window for Angled Hosts</td>
      <td>Windows</td>
      <td>Opening</td>
      <td>True</td>
    </tr>
    <tr>
      <th>77</th>
      <td>Windows\Special</td>
      <td>Face Based Fixed Window for Angled Hosts</td>
      <td>Windows</td>
      <td>Sill/Head</td>
      <td>True</td>
    </tr>
    <tr>
      <th>78</th>
      <td>Windows\Special</td>
      <td>Face Based Fixed Window for Angled Hosts</td>
      <td>Windows</td>
      <td>Hidden Lines</td>
      <td>True</td>
    </tr>
    <tr>
      <th>79</th>
      <td>Windows\Special</td>
      <td>Ellipse with Trim_WIN</td>
      <td>Windows</td>
      <td>Trim Projection</td>
      <td>False</td>
    </tr>
    <tr>
      <th>80</th>
      <td>Windows\Special</td>
      <td>Ellipse with Trim_WIN</td>
      <td>Windows</td>
      <td>Frame/Mullion</td>
      <td>True</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Windows\Special</td>
      <td>Ellipse with Trim_WIN</td>
      <td>Windows</td>
      <td>Glass</td>
      <td>True</td>
    </tr>
    <tr>
      <th>82</th>
      <td>Windows\Special</td>
      <td>Ellipse with Trim_WIN</td>
      <td>Windows</td>
      <td>Opening</td>
      <td>True</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Windows\Special</td>
      <td>Ellipse with Trim_WIN</td>
      <td>Windows</td>
      <td>Elevation Swing</td>
      <td>False</td>
    </tr>
    <tr>
      <th>84</th>
      <td>Windows\Special</td>
      <td>Ellipse with Trim_WIN</td>
      <td>Windows</td>
      <td>Sill/Head</td>
      <td>True</td>
    </tr>
    <tr>
      <th>85</th>
      <td>Windows\Special</td>
      <td>Ellipse with Trim_WIN</td>
      <td>Windows</td>
      <td>Hidden Lines</td>
      <td>True</td>
    </tr>
    <tr>
      <th>86</th>
      <td>Windows\Special</td>
      <td>Ellipse with Trim_WIN</td>
      <td>Windows</td>
      <td>Plan Swing</td>
      <td>False</td>
    </tr>
    <tr>
      <th>87</th>
      <td>Windows\Special</td>
      <td>Curtain Wall Awning_WIN</td>
      <td>Windows</td>
      <td>Frame/Mullion</td>
      <td>True</td>
    </tr>
    <tr>
      <th>88</th>
      <td>Windows\Special</td>
      <td>Curtain Wall Awning_WIN</td>
      <td>Windows</td>
      <td>Glass</td>
      <td>True</td>
    </tr>
    <tr>
      <th>89</th>
      <td>Windows\Special</td>
      <td>Curtain Wall Awning_WIN</td>
      <td>Windows</td>
      <td>Opening</td>
      <td>True</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Windows\Special</td>
      <td>Curtain Wall Awning_WIN</td>
      <td>Windows</td>
      <td>Elevation Swing</td>
      <td>False</td>
    </tr>
    <tr>
      <th>91</th>
      <td>Windows\Special</td>
      <td>Curtain Wall Awning_WIN</td>
      <td>Windows</td>
      <td>Sill/Head</td>
      <td>True</td>
    </tr>
    <tr>
      <th>92</th>
      <td>Windows\Special</td>
      <td>Curtain Wall Awning_WIN</td>
      <td>Windows</td>
      <td>Hidden Lines</td>
      <td>True</td>
    </tr>
    <tr>
      <th>93</th>
      <td>Windows\Special</td>
      <td>Corner Window_WIN</td>
      <td>Windows</td>
      <td>Frame/Mullion</td>
      <td>True</td>
    </tr>
    <tr>
      <th>94</th>
      <td>Windows\Special</td>
      <td>Corner Window_WIN</td>
      <td>Windows</td>
      <td>Glass</td>
      <td>True</td>
    </tr>
    <tr>
      <th>95</th>
      <td>Windows\Special</td>
      <td>Corner Window_WIN</td>
      <td>Windows</td>
      <td>Opening</td>
      <td>True</td>
    </tr>
    <tr>
      <th>96</th>
      <td>Windows\Special</td>
      <td>Corner Window_WIN</td>
      <td>Windows</td>
      <td>Sill/Head</td>
      <td>True</td>
    </tr>
    <tr>
      <th>97</th>
      <td>Windows\Special</td>
      <td>Corner Window_WIN</td>
      <td>Windows</td>
      <td>Hidden Lines</td>
      <td>True</td>
    </tr>
    <tr>
      <th>98</th>
      <td>Windows\Special</td>
      <td>Combination Rtp with Trim_WIN</td>
      <td>Windows</td>
      <td>Trim</td>
      <td>False</td>
    </tr>
    <tr>
      <th>99</th>
      <td>Windows\Special</td>
      <td>Combination Rtp with Trim_WIN</td>
      <td>Windows</td>
      <td>Frame/Mullion</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 5 columns</p>
</div>



## Families with non-BVN subcategories

<b>not_legit</b> lists the families that have wrong subcategories and its wrong subcategory name.


```python
not_legit = fs[fs.BVNsubcat==False]

print "Number of non-BVN subcategories:", not_legit.shape
not_legit.head(10)
```

    Number of non-BVN subcategories: (7578, 5)
    




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FamilyFilePath</th>
      <th>FamilyName</th>
      <th>Category</th>
      <th>Subcategory</th>
      <th>BVNsubcat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Windows</td>
      <td>Overhead</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Windows</td>
      <td>Opening Elevation</td>
      <td>False</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Windows\Structural</td>
      <td>Window_Round Opening_WIN</td>
      <td>Windows</td>
      <td>Overhead</td>
      <td>False</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Windows\Structural</td>
      <td>Window_Round Opening_WIN</td>
      <td>Windows</td>
      <td>Opening Elevation</td>
      <td>False</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Windows\Special</td>
      <td>Window Round_basic</td>
      <td>Windows</td>
      <td>Trim</td>
      <td>False</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Windows\Special</td>
      <td>Window Round_basic</td>
      <td>Windows</td>
      <td>Elevation Swing</td>
      <td>False</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Windows\Special</td>
      <td>Window Round_basic</td>
      <td>Windows</td>
      <td>Plan Swing</td>
      <td>False</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Windows\Special</td>
      <td>Window Lancet_basic</td>
      <td>Windows</td>
      <td>Trim</td>
      <td>False</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Windows\Special</td>
      <td>Window Lancet_basic</td>
      <td>Windows</td>
      <td>Elevation Swing</td>
      <td>False</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Windows\Special</td>
      <td>Window Lancet_basic</td>
      <td>Windows</td>
      <td>Plan Swing</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>



## No. of times non-BVN subcategories are used


```python
print len(not_legit.Subcategory.unique())
not_legit.Subcategory.value_counts()
```

    642
    




    Heavy Lines                             480
    Waste Outlets                           232
    FHRs/Hydrants                           226
    Elevation Swing                         189
    Toilet/Bidets                           178
    Plan Swing                              164
    Shower Fall                             154
    Circulation Space                       141
    Gas Supply Fixtures                     140
    Gas Cooking Equipment                   140
    Location Lines                          132
    Thin Lines                              110
    Fittings                                101
    Property Line Segments                   91
    Survey Point                             91
    Project Base Point                       91
    Wide Lines                               84
    Plan rep_Leaf_Thicknessâ€‹               78
    Plan rep_Leaf_Single line                76
    Glazing - Aluminium                      68
    Door Swing                               67
    Elevation_Swingâ€‹                       66
    Elevation_Linework_Swing                 59
    Hardware_Setout reference                59
    End Panel                                59
    Elevation_Linework_Shelving              59
    Door/Drawer Leaf                         59
    Elevation_Linework_Carcass thickness     59
    Section_Linework_Shelf hole              59
    Carcass                                  59
                                           ... 
    FORMAT                                    1
    Park Bench                                1
    Traffic Lights                            1
    DIMENSIONS                                1
    CW100                                     1
    Linee spesse                              1
    TEX25                                     1
    Awning Strut                              1
    Chain Gate                                1
    ZEE Sextion                               1
    Win-Door Arrow                            1
    SEAT-LUMBAR                               1
    Beam Hidden                               1
    Awning Sheeting                           1
    Solid 3 Black                             1
    Taps/Mixer                                1
    Hidden Tight                              1
    Glides                                    1
    Glider                                    1
    AM_8N                                     1
    LINE35                                    1
    Cubicle_Wall                              1
    Slab Fixture                              1
    SEAT-BASE                                 1
    SEAT-CASTER                               1
    Grate Drain                               1
    Awning Frame                              1
    AFL Field                                 1
    D2_TRUCK_TURNING                          1
    BALUSTRADE TYPE 4                         1
    Name: Subcategory, dtype: int64



# REVIT VERSION

**rv_path** and **rv** reads from the ParameterValuesByTypes excel file.

**NOTE:** The columns - "FamilyEditedLast", "ParameterName", "ParameterValue", "ParameterIsInstance", "ParamterIsFormula", "ParameterIsReporting", "ParameterStorageType" are dropped from the table below.


```python
rv_path = os.path.join(directory, file_dict["ParameterValuesByTypes"])
rv = pd.read_excel(rv_path)

rv.drop(["FamilyEditedLast", "ParameterName", "ParameterValue", "ParameterIsInstance", "ParamterIsFormula", "ParameterIsReporting", "ParameterStorageType"],axis=1,inplace=True)

rv.head()
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FamilyFilePath</th>
      <th>FamilyName</th>
      <th>RevitVersion</th>
      <th>FamilyCategory</th>
      <th>FamilyTypeName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>\\dc2-file001\Practice\InfoTech\BIM\Revit\Revi...</td>
      <td>Window_Square Opening_WIN.rfa</td>
      <td>2015</td>
      <td>Windows</td>
      <td>0400 x 1200mm</td>
    </tr>
    <tr>
      <th>1</th>
      <td>\\dc2-file001\Practice\InfoTech\BIM\Revit\Revi...</td>
      <td>Window_Square Opening_WIN.rfa</td>
      <td>2015</td>
      <td>Windows</td>
      <td>0400 x 1200mm</td>
    </tr>
    <tr>
      <th>2</th>
      <td>\\dc2-file001\Practice\InfoTech\BIM\Revit\Revi...</td>
      <td>Window_Square Opening_WIN.rfa</td>
      <td>2015</td>
      <td>Windows</td>
      <td>0400 x 1200mm</td>
    </tr>
    <tr>
      <th>3</th>
      <td>\\dc2-file001\Practice\InfoTech\BIM\Revit\Revi...</td>
      <td>Window_Square Opening_WIN.rfa</td>
      <td>2015</td>
      <td>Windows</td>
      <td>0400 x 1200mm</td>
    </tr>
    <tr>
      <th>4</th>
      <td>\\dc2-file001\Practice\InfoTech\BIM\Revit\Revi...</td>
      <td>Window_Square Opening_WIN.rfa</td>
      <td>2015</td>
      <td>Windows</td>
      <td>0400 x 1200mm</td>
    </tr>
  </tbody>
</table>
</div>



## Number of Families in a Revit Version


```python
nameAndVersion = rv[["RevitVersion", "FamilyName"]]
nameAndVersion.drop_duplicates(inplace=True)

rv_group = nameAndVersion.groupby("RevitVersion").agg("count")
```

    Q:\Users\arivera\AppData\Local\Continuum\Anaconda2\lib\site-packages\pandas\util\decorators.py:91: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame
    
    See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
      return func(*args, **kwargs)
    


```python
rv_group.head(9)
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FamilyName</th>
    </tr>
    <tr>
      <th>RevitVersion</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010</th>
      <td>3</td>
    </tr>
    <tr>
      <th>2011</th>
      <td>22</td>
    </tr>
    <tr>
      <th>2012</th>
      <td>342</td>
    </tr>
    <tr>
      <th>2013</th>
      <td>308</td>
    </tr>
    <tr>
      <th>2014</th>
      <td>1617</td>
    </tr>
    <tr>
      <th>2015</th>
      <td>2610</td>
    </tr>
    <tr>
      <th>2016</th>
      <td>47</td>
    </tr>
    <tr>
      <th>2017</th>
      <td>2</td>
    </tr>
    <tr>
      <th>MEP 2011</th>
      <td>85</td>
    </tr>
  </tbody>
</table>
</div>




```python
rv_group.plot(kind="bar", grid=True);
plt.title("Number of families in each Revit Version", fontsize=20)
plt.xlabel("Revit Version", fontsize=15)
plt.ylabel("Number of families", fontsize=15)
plt.show()
```


![png]({{site.baseurl}}/assets/first/output_79_0.png)


## Filter for names of families in a revit version

Change the Revit Version value in <b>rv_filter</b> to filter the list of family names for a particular Revit version


```python
rv_filter = rv[rv.RevitVersion==2014]

rv_filter.drop("FamilyTypeName",axis=1,inplace=True)

rv_filter.drop_duplicates(inplace=True)

rv_filter.head(10)
```

    Q:\Users\arivera\AppData\Local\Continuum\Anaconda2\lib\site-packages\ipykernel\__main__.py:3: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame
    
    See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
      app.launch_new_instance()
    




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FamilyFilePath</th>
      <th>FamilyName</th>
      <th>RevitVersion</th>
      <th>FamilyCategory</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>467</th>
      <td>\\dc2-file001\Practice\InfoTech\BIM\Revit\Revi...</td>
      <td>Skylight_Operable_WIN.rfa</td>
      <td>2014</td>
      <td>Windows</td>
    </tr>
    <tr>
      <th>1426</th>
      <td>\\dc2-file001\Practice\InfoTech\BIM\Revit\Revi...</td>
      <td>Sliding_Single Row_XOX_WIN.rfa</td>
      <td>2014</td>
      <td>Windows</td>
    </tr>
    <tr>
      <th>1489</th>
      <td>\\dc2-file001\Practice\InfoTech\BIM\Revit\Revi...</td>
      <td>Sliding_Single Row_XOOX_WIN.rfa</td>
      <td>2014</td>
      <td>Windows</td>
    </tr>
    <tr>
      <th>1552</th>
      <td>\\dc2-file001\Practice\InfoTech\BIM\Revit\Revi...</td>
      <td>Sliding_Single Row_XO_WIN.rfa</td>
      <td>2014</td>
      <td>Windows</td>
    </tr>
    <tr>
      <th>1615</th>
      <td>\\dc2-file001\Practice\InfoTech\BIM\Revit\Revi...</td>
      <td>Sliding_Single Row_OXXO_WIN.rfa</td>
      <td>2014</td>
      <td>Windows</td>
    </tr>
    <tr>
      <th>1741</th>
      <td>\\dc2-file001\Practice\InfoTech\BIM\Revit\Revi...</td>
      <td>Sliding-Metal Frame-AWS 461 End_WIN.rfa</td>
      <td>2014</td>
      <td>Windows</td>
    </tr>
    <tr>
      <th>1805</th>
      <td>\\dc2-file001\Practice\InfoTech\BIM\Revit\Revi...</td>
      <td>Sliding-Metal Frame-AWS 461 Centre_WIN.rfa</td>
      <td>2014</td>
      <td>Windows</td>
    </tr>
    <tr>
      <th>1869</th>
      <td>\\dc2-file001\Practice\InfoTech\BIM\Revit\Revi...</td>
      <td>Sliding-Metal Frame-AWS 461 Both_WIN.rfa</td>
      <td>2014</td>
      <td>Windows</td>
    </tr>
    <tr>
      <th>2856</th>
      <td>\\dc2-file001\Practice\InfoTech\BIM\Revit\Revi...</td>
      <td>Louvre Window_WIN.rfa</td>
      <td>2014</td>
      <td>Windows</td>
    </tr>
    <tr>
      <th>3970</th>
      <td>\\dc2-file001\Practice\InfoTech\BIM\Revit\Revi...</td>
      <td>Louvre Window_Timber_WIN .rfa</td>
      <td>2014</td>
      <td>Windows</td>
    </tr>
  </tbody>
</table>
</div>



## Number of Categories in a particular Revit Version = 2014


```python
catAndVersion = rv_filter[["RevitVersion", "FamilyCategory"]]

catAndVersion_group = catAndVersion.groupby("FamilyCategory").agg("count")

catAndVersion_group.sort_values(by="RevitVersion",ascending=False, inplace=True)

catAndVersion_group.head()
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RevitVersion</th>
    </tr>
    <tr>
      <th>FamilyCategory</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Plumbing Fixtures</th>
      <td>225</td>
    </tr>
    <tr>
      <th>Doors</th>
      <td>187</td>
    </tr>
    <tr>
      <th>Specialty Equipment</th>
      <td>160</td>
    </tr>
    <tr>
      <th>Detail Items</th>
      <td>156</td>
    </tr>
    <tr>
      <th>Furniture</th>
      <td>133</td>
    </tr>
  </tbody>
</table>
</div>




```python
catAndVersion_group.plot(kind="bar", grid=True);
plt.title("Number of families in particular category of a Revit Version (Check rv_filter for Revit version value)", fontsize=20)
plt.xlabel("Family Categories", fontsize=15)
plt.ylabel("Number of families", fontsize=15)
plt.show()
```


![png]({{site.baseurl}}/assets/first/output_84_0.png)


# UNITS

**u_path** and **u** reads from the ParameterValuesByTypes excel file.


```python
u_path = os.path.join(directory, file_dict["Units"])
u = pd.read_excel(u_path)

u["FamilyFilePath"] = u.apply(remove_rfaName, axis=1)
u["FamilyFilePath"] = u.apply(stripCommonPath, axis=1)
u["FamilyName"] = u.apply(stripFileType, axis=1)

u.head()
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FamilyFilePath</th>
      <th>FamilyName</th>
      <th>Unit</th>
      <th>Accuracy</th>
      <th>UnitDisplay</th>
      <th>UnitSymbol</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Number</td>
      <td>0.000001</td>
      <td>General</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Length</td>
      <td>1.000000</td>
      <td>Millimeters</td>
      <td>(UST_NONE)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Area</td>
      <td>0.010000</td>
      <td>Square meters</td>
      <td>(UST_NONE)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Volume</td>
      <td>0.010000</td>
      <td>Cubic meters</td>
      <td>(UST_NONE)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Angle</td>
      <td>0.010000</td>
      <td>Decimal degrees</td>
      <td>Â° (UST_DEGREE_SYMBOL)</td>
    </tr>
  </tbody>
</table>
</div>



## Units families are using


```python
unit_group = u.groupby("UnitDisplay").agg("count")
unit_group.sort_values(by="FamilyName",ascending=False, inplace=True)

unit_group["FamilyName"].plot(kind="bar", grid=True);
plt.title("Units families are using", fontsize=20)
plt.xlabel("Unit Display", fontsize=15)
plt.ylabel("Number of Families", fontsize=15)
plt.show()
```


![png]({{site.baseurl}}/assets/first/output_88_0.png)



```python
def get_unit_type(row):
    general_units = [u'General']

    metric_units = [u'Decimal degrees', 
                    u'Millimeters', 
                    u'Cubic meters',
                    u'Square meters', 
                    u'Square millimeters', 
                    u'Liters',
                    u'Meters', 
                    u'Meters and centimeters', ]

    us_evil_units = [u'Cubic feet',
                     u'Square feet',
                     u'Decimal inches',
                     u'Feet and fractional inches',
                     u'Square inches']
    if row.UnitDisplay in general_units:
        return "General"
    elif row.UnitDisplay in metric_units:
        return "Metric"
    elif row.UnitDisplay in us_evil_units:
        return "Evil"
    else:
        return "Alien"
```


```python
u["unit_type"] = u.apply(get_unit_type, axis=1)
u.head()
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FamilyFilePath</th>
      <th>FamilyName</th>
      <th>Unit</th>
      <th>Accuracy</th>
      <th>UnitDisplay</th>
      <th>UnitSymbol</th>
      <th>unit_type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Number</td>
      <td>0.000001</td>
      <td>General</td>
      <td>n/a</td>
      <td>General</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Length</td>
      <td>1.000000</td>
      <td>Millimeters</td>
      <td>(UST_NONE)</td>
      <td>Metric</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Area</td>
      <td>0.010000</td>
      <td>Square meters</td>
      <td>(UST_NONE)</td>
      <td>Metric</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Volume</td>
      <td>0.010000</td>
      <td>Cubic meters</td>
      <td>(UST_NONE)</td>
      <td>Metric</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Angle</td>
      <td>0.010000</td>
      <td>Decimal degrees</td>
      <td>Â° (UST_DEGREE_SYMBOL)</td>
      <td>Metric</td>
    </tr>
  </tbody>
</table>
</div>




```python
fams = u.FamilyName.unique()

def inline_units(name):
    this_fam = u[u.FamilyName == name]
    new_row = {"FamilyName": name,
               "Number_unit_type": list(this_fam[this_fam.Unit=="Number"].unit_type)[0],
               "Length_unit_type": list(this_fam[this_fam.Unit=="Length"].unit_type)[0],
               "Area_unit_type":   list(this_fam[this_fam.Unit=="Area"  ].unit_type)[0],
               "Volume_unit_type": list(this_fam[this_fam.Unit=="Volume"].unit_type)[0],
               "Angle_unit_type":  list(this_fam[this_fam.Unit=="Angle" ].unit_type)[0]}
    return new_row
    
f = pd.DataFrame([inline_units(f) for f in fams])
```

## Families that are using Metric AND imperial Units


```python
m="Metric"
dirty_families = f[(f.Angle_unit_type!=m)|(f.Area_unit_type!=m)|(f.Length_unit_type!=m)|(f.Volume_unit_type!=m)]

dirty_families.head()
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Angle_unit_type</th>
      <th>Area_unit_type</th>
      <th>FamilyName</th>
      <th>Length_unit_type</th>
      <th>Number_unit_type</th>
      <th>Volume_unit_type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>363</th>
      <td>Metric</td>
      <td>Evil</td>
      <td>Paper Shredder_SEQ</td>
      <td>Metric</td>
      <td>General</td>
      <td>Evil</td>
    </tr>
    <tr>
      <th>371</th>
      <td>Metric</td>
      <td>Evil</td>
      <td>Pool Cue_SEQ</td>
      <td>Metric</td>
      <td>General</td>
      <td>Evil</td>
    </tr>
    <tr>
      <th>492</th>
      <td>Metric</td>
      <td>Evil</td>
      <td>Tennis Court (indoor)_SEQ</td>
      <td>Evil</td>
      <td>General</td>
      <td>Evil</td>
    </tr>
    <tr>
      <th>499</th>
      <td>Metric</td>
      <td>Metric</td>
      <td>RearFolding_Basketball_Backstop_1937_SEQ</td>
      <td>Metric</td>
      <td>General</td>
      <td>Evil</td>
    </tr>
    <tr>
      <th>531</th>
      <td>Metric</td>
      <td>Evil</td>
      <td>Exercise Equipment - Step Machine</td>
      <td>Metric</td>
      <td>General</td>
      <td>Evil</td>
    </tr>
  </tbody>
</table>
</div>



There are {{dirty_families.shape[0]}} dirty families. {{(dict(dirty_families.Angle_unit_type.value_counts())["Metric"] / dirty_families.shape[0])*100}}% of angles are Metric.


```python
plt.figure(1)
for i, col in enumerate([u'Angle_unit_type', u'Area_unit_type', u'Length_unit_type', u'Volume_unit_type']):

    plt.subplot(221+i)
    dirty_families[col].value_counts().plot(kind="bar")
    plt.title(col)

plt.show()
```


![png]({{site.baseurl}}/assets/first/output_95_0.png)


# PARAMETERS

**p_path** and **p** reads from the ParameterValuesByTypes excel file.


```python
p_path = os.path.join(directory, file_dict["Parameters"])
p = pd.read_excel(p_path)

p["FamilyFilePath"] = p.apply(remove_rfaName, axis=1)
p["FamilyFilePath"] = p.apply(stripCommonPath, axis=1)
p["FamilyName"] = p.apply(stripFileType, axis=1)

p.head()
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FamilyFilePath</th>
      <th>FamilyName</th>
      <th>ParameterName</th>
      <th>ParameterIsDeterminedByFormula</th>
      <th>ParameterIsInstance</th>
      <th>ParameterIsReporting</th>
      <th>ParameterStorageType</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Analytic Construction</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>String</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Assembly Code</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>String</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Construction Type</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>String</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Cost</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>Double</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Description</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>String</td>
    </tr>
  </tbody>
</table>
</div>



## Number of Parameters of Families


```python
grouped_parameters = p.groupby("FamilyName").agg(['count'])
```


```python
grouped_parameters["ParameterName"].hist(bins=50);
plt.title("Number of parameters of families", fontsize=20)
plt.xlabel("Number of parameters", fontsize=15)
plt.ylabel("Number of families", fontsize=15)
plt.show()
```


![png]({{site.baseurl}}/assets/first/output_100_0.png)


## Numbers of Parameters of Families (High Offenders)


```python
param_counts = grouped_parameters["ParameterName"]
param_counts[param_counts["count"]>100]
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
    </tr>
    <tr>
      <th>FamilyName</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Accordion_Double_DOR</th>
      <td>128</td>
    </tr>
    <tr>
      <th>Accordion_Single_DOR</th>
      <td>125</td>
    </tr>
    <tr>
      <th>Base Cabinet_Corner_LShape_CAS</th>
      <td>184</td>
    </tr>
    <tr>
      <th>Base Cabinet_Dishwasher_CAS</th>
      <td>161</td>
    </tr>
    <tr>
      <th>Base Cabinet_Door with Drawer_CAS</th>
      <td>171</td>
    </tr>
    <tr>
      <th>Base Cabinet_Double_CAS</th>
      <td>184</td>
    </tr>
    <tr>
      <th>Base Cabinet_Drawer_1_CAS</th>
      <td>166</td>
    </tr>
    <tr>
      <th>Base Cabinet_Drawer_2_CAS</th>
      <td>168</td>
    </tr>
    <tr>
      <th>Base Cabinet_Drawer_3_CAS</th>
      <td>170</td>
    </tr>
    <tr>
      <th>Base Cabinet_Drawer_4_CAS</th>
      <td>172</td>
    </tr>
    <tr>
      <th>Base Cabinet_Drawer_5_CAS</th>
      <td>174</td>
    </tr>
    <tr>
      <th>Base Cabinet_GLI</th>
      <td>110</td>
    </tr>
    <tr>
      <th>Base Cabinet_Oven with Drawer_CAS</th>
      <td>165</td>
    </tr>
    <tr>
      <th>Base Cabinet_Single_Left_CAS</th>
      <td>184</td>
    </tr>
    <tr>
      <th>Base Cabinet_Single_Right_CAS</th>
      <td>184</td>
    </tr>
    <tr>
      <th>Base Cabinet_Sliding Inset_Double_CAS</th>
      <td>180</td>
    </tr>
    <tr>
      <th>Bench_Cafe_Long_CAS</th>
      <td>103</td>
    </tr>
    <tr>
      <th>Bench_Cafe_Long_Cafe_CAS</th>
      <td>103</td>
    </tr>
    <tr>
      <th>Bench_Cafe_Long_Suite_CAS</th>
      <td>105</td>
    </tr>
    <tr>
      <th>Bench_Cafe_Short_CAS</th>
      <td>103</td>
    </tr>
    <tr>
      <th>Bench_Cafe_Short_Suite_CAS</th>
      <td>105</td>
    </tr>
    <tr>
      <th>Bench_Handwash_Cleansuite_CAS</th>
      <td>117</td>
    </tr>
    <tr>
      <th>Bench_I Shaped_CAS</th>
      <td>120</td>
    </tr>
    <tr>
      <th>Bench_L Shaped (Angle)_CAS</th>
      <td>109</td>
    </tr>
    <tr>
      <th>Bench_L Shaped_CAS</th>
      <td>116</td>
    </tr>
    <tr>
      <th>Bench_Lab_Cleansuite_CAS</th>
      <td>114</td>
    </tr>
    <tr>
      <th>Bench_Lab_Plain_CAS</th>
      <td>107</td>
    </tr>
    <tr>
      <th>Bench_Lab_Plain_End_CAS</th>
      <td>113</td>
    </tr>
    <tr>
      <th>Bench_Lab_Plastic_CAS</th>
      <td>114</td>
    </tr>
    <tr>
      <th>Bench_Lab_Sink_CAS</th>
      <td>107</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>Sliding_Framed_3Panel_OOX_DOR</th>
      <td>110</td>
    </tr>
    <tr>
      <th>Sliding_Framed_3Panel_OXO_DOR</th>
      <td>110</td>
    </tr>
    <tr>
      <th>Sliding_Framed_3Panel_OXX_DOR</th>
      <td>110</td>
    </tr>
    <tr>
      <th>Sliding_Framed_4Panel_OOOX_DOR</th>
      <td>110</td>
    </tr>
    <tr>
      <th>Sliding_Framed_4Panel_OXXO_DOR</th>
      <td>110</td>
    </tr>
    <tr>
      <th>Sliding_Framed_6Panel_OXXXXO_DOR</th>
      <td>110</td>
    </tr>
    <tr>
      <th>Swing_Double_DOR</th>
      <td>239</td>
    </tr>
    <tr>
      <th>Swing_Single_DOR</th>
      <td>229</td>
    </tr>
    <tr>
      <th>Tower_Oven with Microwave_Drawers_1_CAS</th>
      <td>191</td>
    </tr>
    <tr>
      <th>Tower_Oven with Microwave_Drawers_2_CAS</th>
      <td>192</td>
    </tr>
    <tr>
      <th>Tower_Oven with Microwave_Single_Left_CAS</th>
      <td>180</td>
    </tr>
    <tr>
      <th>Tower_Oven with Microwave_Single_Right_CAS</th>
      <td>180</td>
    </tr>
    <tr>
      <th>Tower_Oven_Drawers_1_CAS</th>
      <td>190</td>
    </tr>
    <tr>
      <th>Tower_Oven_Drawers_2_CAS</th>
      <td>191</td>
    </tr>
    <tr>
      <th>Tower_Oven_Single_Left_CAS</th>
      <td>179</td>
    </tr>
    <tr>
      <th>Tower_Oven_Single_Right_CAS</th>
      <td>179</td>
    </tr>
    <tr>
      <th>Utility_Point_Large_Left_CAS</th>
      <td>105</td>
    </tr>
    <tr>
      <th>Utility_Point_Large_Left_with Column_CAS</th>
      <td>105</td>
    </tr>
    <tr>
      <th>Wall Cabinet_Corner_L Shape_CAS</th>
      <td>180</td>
    </tr>
    <tr>
      <th>Wall Cabinet_Double_CAS</th>
      <td>180</td>
    </tr>
    <tr>
      <th>Wall Cabinet_HorizontalDoor_CAS</th>
      <td>178</td>
    </tr>
    <tr>
      <th>Wall Cabinet_Microwave_Double_CAS</th>
      <td>182</td>
    </tr>
    <tr>
      <th>Wall Cabinet_Microwave_HorizontalDoor_CAS</th>
      <td>180</td>
    </tr>
    <tr>
      <th>Wall Cabinet_Microwave_Single_Left_CAS</th>
      <td>182</td>
    </tr>
    <tr>
      <th>Wall Cabinet_Microwave_Single_Right_CAS</th>
      <td>182</td>
    </tr>
    <tr>
      <th>Wall Cabinet_Shelf Unit_CAS</th>
      <td>159</td>
    </tr>
    <tr>
      <th>Wall Cabinet_Single_Left_CAS</th>
      <td>180</td>
    </tr>
    <tr>
      <th>Wall Cabinet_Single_Right_CAS</th>
      <td>180</td>
    </tr>
    <tr>
      <th>Wall Cabinet_Sliding Inset_Double_CAS</th>
      <td>177</td>
    </tr>
    <tr>
      <th>Wall Cabinet_Sliding_Double_CAS</th>
      <td>178</td>
    </tr>
  </tbody>
</table>
<p>140 rows × 1 columns</p>
</div>



# SHARED PARAMETERS

## Checks to see if parameters are part of BVN's shared parameter list


```python
p_BVN = ['_SPEC_WILKHAHN_ANSI/BIFMA_STANDARDS','_SPEC_WILKHAHN_DIN_EN_STANDARDS','_SPEC_WILKHAHN_FURNTECH-AFRDI_BLUE_TICK','_SPEC_WILKHAHN_FURNTECH-AFRDI_GREEN_TICK','_SPEC_WILKHAHN_GS_SYMBOL','_SPEC_WILKHAHN_Model','_SPEC_WILKHAHN_NPR_STANDARDS','_SPEC_WILKHAHN_Part_Number','_SPEC_WILKHAHN_Table_Length','_SPEC_WILKHAHN_Table_Width','_SPEC_WILKHAHN_URL','_SPEC_WILKHAHN_Version','_WILKHAHN Table Height','_WILKHAHN Table Length','_WILKHAHN Table Width','A3 Scale','Acoustic Performance','Acoustic Rating Rw','Adaptable','Additional Info- Fourth Line','Area Colour','Area_Colour_Bvn','Armpad Finish','AS1428 Tolerance','AS1482 Tolerance','Asset Number','Author','Back Finish','Balcony Area','Bars','Base Finish','Base Price','Bench_Material_Bvn','Bench_Thickness_Bvn','Benchtop Material','Benchtopfinish','Benchtopmaterial','Benchtopthickness','Bolt Latch','Briefed Area','Building Name','BVN Alphabet','Carcase Offset off Wall','Carcasefinish','Carcasematerial','Carcass Material','Carcass_Material_Bvn','Carcess_Thickness_Bvn','Caseworkoveralldepth','Caseworkoverallheight','Caseworkoverallwidth','Catalog','Catalog Code','Category Color','Cb Classification','Cb Code 1','Cb Description','Cb Group','Cdeb_Doorid','Cdeb_Rminstid','Cdeb_Status','Ceiling Acoustic Rating','Ceiling_Height_Bvn','Cf_1','Cf_2','CheckedBy_ANZRS','Clear Opening','Client Project Number','Closer','Column Length','Configured By','Configured By','Consultant 01','Consultant 01 Details','Consultant 02','Consultant 02 Details','Consultant 03','Consultant 03 Details','Consultant 04','Consultant 04 Details','Consultant 05','Consultant 05 Details','Copyright','Copyright','Copyright ©','Core','Core Name','CreatedBy_ANZRS','CreatedByURL_ANZRS','DAF_Created By_Username_t','DAF_Modified By_Username_t','DAF_Modified_Date_t','DAF_Modified_Date_t','DAF_Owned By_t','DAF_Revision number_t','Department_BVN','Depth_Bvn','Depth_Two_Bvn','Detailedcategory','Discipline','Door Grille/Undercut','Door Leaf Height','Door Leaf Thickness','Door Leaf Type','Door Leaf Width','Door Panel Height','Door Panel Thickness','Door Seals','Door Stop','Door Thickness','Door Thickness','Door Undercut','Double Rebate','Double Swing','Either Side Swing Away','Either Side Swing Towards','Electric Locking','Electromagnetic Hold Open','End Panel Side I Finish','End Panel Side II Finish','Expected Lifespan (Years)','Ext Frame_Offset EQUAL Host Wall thickness_i','FF&E Code','FF&E Comments','FF&E Description','FF&E Group','FF&E Issue','FF&E Item','FF&E Supplier','Ff_1','Ff_2','FF_SPECIFIC_1','Fire/Smoke Door','Flux Id','Frame Finish','Frame Overlaps Wall','Frame Profile','Frame to Match Wall Thickness','Front Panel Finish','Front Swing Away','Front Swing Towards','Frontpanel_Left_Material_Bvn','Frontpanel_Right_Material_Bvn','Frontpanel_Single_Material_Bvn','Generic Room Sheet Reference','Glazing','Glazing Material','Grade','Grid Prefix','Handle Height','Handle Offset','Head Details','Height_Bvn','Height_Skirting_Bvn','Height_Two_Bvn','Hfbs_Sub_Department','Hinge Side Swing Away','Hinge Side Swing Towards','HsbType','Ideate BIMLink','ItemCode','ItemCode_2','ItemDescription','ItemDescription_2','ItemGroup','ItemGroup_2','Jamb Details','Kicker Material','Kickerfinish','Kickerheight','Kickermaterial','Latch Side Swing Away','Latch Side Swing Towards','Leaf 1 Width','Leaf 2 Width','Leaf Height','Length','Level - Second Line','Lining_"Opposite Side"','Lining_"Placement Side"','Link_Status','Lock/Latch','Maintenance Schedule (Months)','Mass per m','Material Door Panel','Material Door Panel EXT','Material Door Panel INT','Material Frame','Material View Panel','Meeting Stile Detail','Modified Issue','ModifiedIssue','ModifiedIssue','Mounted_Top_Bvn','Mounting_Height_Bvn','Mounting_Height_Centre_Bvn','Mounting_Height_Top_Bvn','MOUNTING_HEIGHT_US_BVN','Mullion Height','No. of Parks','Original Model By','Other Protection','Overall_Height_Bvn','Package','Package Qty','Panel 1 Height','Panel 1 Width','Panel Height','Panel Width','Place in Structural Wall_i','Product Documentation Link','Project','Project Manager','Project Managers Details','Project Stage','Project Stage Code','Project Type','Protection on Pull Side','Protection on Push Side','Pull Handle','Pull Side Finish Zone','Push Plates','Push Side Finish Zone','Radius','Reed Switch','Revision','Roller Catch','Room Code','Room Colour','Room Name','rwcalc_Carcase Inside Width','rwcalc_Cupboard1 Height','rwcalc_Double Panel Width','rwcalc_Front Panel Visibility','rwcalc_Kickplate On','rwcalc_Kickplate Side I setback','rwcalc_Kickplate Side II setback','rwcalc_Kickplate Visibility','rwcalc_Panel Back Offset','rwcalc_Panel Inset Side I','rwcalc_Panel Inset Side II','rwcalc_Panel Offset off Base','rwcalc_Panel Thk Base','rwcalc_Panel Thk Side I','rwcalc_Panel Thk Side II','rwcalc_Panel Thk Top','rwcalc_Rail Offset','rwcalc_Rail1','rwcalc_Rail2','rwcalc_Real Panel Base Thk','rwcalc_Real Panel Side I Thk','rwcalc_Real Panel Side II Thk','rwcalc_Real Panel Top Thk','rwcalc_Shelf Depth','rwcalc_Shelf1','rwcalc_Shelf2','rwcalc_Shelf2 Height','rwcalc_Shelf3','rwcalc_Shelf3 Height','rwcalc_Shelf4','rwcalc_Shelf4 Height','rwcalc_Shelf5','rwcalc_Shelf5 Height','rwcalc_Shelf6','rwcalc_Shelf6 Height','rwcalc_Show Double Front Panel','rwcalc_Show Single Front Panel','rwcalc_Single Panel Width','rwcalc_Swappable','rwcalc_Symbolic Depth','Seat/Back Fabric','Security Rating (SR1 ,SR2)','SEPP 65 - Cross Ventilation','SEPP 65 - Solar Access','SEPP 65 - South Aspect','SEPP65 - Daylight Access','SEPP65_Cross Ventilation','SEPP65_Solar Access','SEPP65_South Facing','Side I Divider Panel','Side I End Panel','Side I End Panel Extend Back','Side I Kickplate Flush','Side I Shadow Margin','Side II Divider Panel','Side II End Panel','Side II End Panel Extend Back','Side II Kickplate Flush','Side II Shadow Margin','Sill Details','Small Panel Width','Sp_Area_Designed','Sp_Ceiling_Height','Sp_Circulation_Area','Sp_Comments','Sp_Department','Sp_Depth','Sp_Gfa_Factor','Sp_Material_Ceilings','Sp_Material_Walls','Sp_Net_Area','Sp_Per_Unit_Area','Sp_Room_Name','Sp_Room_Number','Sp_Total_Gfa_Area','Sp_Unique_Id','Sp_Units','Sp_Width','Special Hardware','SR Document GUID','SR View Calculation Settings','Stage','STF_Parking_BayAngle_t','STF_Parking_Disabled_YesNo_t','STF_Parking_Stripe_End_i','STF_Parking_Wheelstop_Depth_t','STF_Parking_Wheelstop_Height_t','STF_Parking_Wheelstop_Material_t','STF_Parking_Wheelstop_Position_t','STF_Parking_Wheelstop_Width_t','STF_Parking_Wheelstop_YesNo_t','STF_ParkingBay_Depth_t','STF_ParkingBay_Width_t','Structural Opening','Structural Opening Height','Sub Discipline Title - Third','Sub-Department','Swing Angle','Swing Angle','Thickness_Shelf','Unit Type','UTSEquipmentCategories','View','View Panel','View Panel Height','View Panel Inset','View Panel Sill','View Panel Width','Wall_Special Finish','Warranty Duration (Years)','Watermarked By','Wf_E_1','Wf_E_2','Wf_N_1','Wf_N_2','Wf_S_1','Wf_S_2','Wf_W_1','Wf_W_2','Width_Bvn','Width_Corner_Bvn','Width_Counter_Dda_Bvn','Width_Two_Bvn','Window Blind Type','Window Jockey Sash','Window Louvre','Window Shade Centre','Window Shade Left','Window Shade Right','Window Shade Top','Windowframefinish','Windowframematerial','Windowframetype','Windowglazingtype','Windowheadheight','Windowoverallframeheight','Windowoverallframewidth','WNF_Ext Frame_Offset_Internal Skin_i','WNF_Frame_Surround_Depth_t','WNF_Frame_Surround_Width_t','WNF_Overall Frame Height_t','WNF_Overall Frame Width_t','WNF_Panel_Main Fixed_Height_t','WNF_Panel_Main Fixed_Width_t','WNP_Schedule Filter_Louvre_t','Y-Tower Finish','Zone']

def is_legit_param(row):
    return row.ParameterName in p_BVN

p["BVNparam"] = p.apply(is_legit_param, axis=1)

p.head(10)
```

    Q:\Users\arivera\AppData\Local\Continuum\Anaconda2\lib\site-packages\ipykernel\__main__.py:4: UnicodeWarning: Unicode equal comparison failed to convert both arguments to Unicode - interpreting them as being unequal
    




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FamilyFilePath</th>
      <th>FamilyName</th>
      <th>ParameterName</th>
      <th>ParameterIsDeterminedByFormula</th>
      <th>ParameterIsInstance</th>
      <th>ParameterIsReporting</th>
      <th>ParameterStorageType</th>
      <th>BVNparam</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Analytic Construction</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>String</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Assembly Code</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>String</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Construction Type</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>String</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Cost</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>Double</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Description</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>String</td>
      <td>False</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Heat Transfer Coefficient (U)</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>Double</td>
      <td>False</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Height</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>Double</td>
      <td>False</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Keynote</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>String</td>
      <td>False</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Manufacturer</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>String</td>
      <td>False</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Model</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>String</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>



## Number of parameters that are using SP vs non-SP


```python
using_shared_param = p.groupby("BVNparam").agg(["count"])
```


```python
using_shared_param["FamilyName"].plot(kind="bar", grid=True);
plt.title("Number of parameters from SP vs non SP", fontsize=20)
plt.xlabel("SP vs non-SP", fontsize=15)
plt.ylabel("Number of parameters", fontsize=15)
plt.show()
```


![png]({{site.baseurl}}/assets/first/output_108_0.png)


## Families that are using shared parameters


```python
nameAndSp = p[["FamilyName", "ParameterName", "BVNparam"]]

nameAndSp.head(10)
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FamilyName</th>
      <th>ParameterName</th>
      <th>BVNparam</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Window_Square Opening_WIN</td>
      <td>Analytic Construction</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Window_Square Opening_WIN</td>
      <td>Assembly Code</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Window_Square Opening_WIN</td>
      <td>Construction Type</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Window_Square Opening_WIN</td>
      <td>Cost</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Window_Square Opening_WIN</td>
      <td>Description</td>
      <td>False</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Window_Square Opening_WIN</td>
      <td>Heat Transfer Coefficient (U)</td>
      <td>False</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Window_Square Opening_WIN</td>
      <td>Height</td>
      <td>False</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Window_Square Opening_WIN</td>
      <td>Keynote</td>
      <td>False</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Window_Square Opening_WIN</td>
      <td>Manufacturer</td>
      <td>False</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Window_Square Opening_WIN</td>
      <td>Model</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>




```python
not_legit_param = nameAndSp[nameAndSp.BVNparam==True]

print "Number of non-BVN subcategories:", not_legit_param.shape

not_legit_param.head(10)
```

    Number of non-BVN subcategories: (22866, 3)
    




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FamilyName</th>
      <th>ParameterName</th>
      <th>BVNparam</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>32</th>
      <td>Window_Round Opening_WIN</td>
      <td>Radius</td>
      <td>True</td>
    </tr>
    <tr>
      <th>58</th>
      <td>Window Round_basic</td>
      <td>Material Frame</td>
      <td>True</td>
    </tr>
    <tr>
      <th>87</th>
      <td>Window Lancet_basic</td>
      <td>Material Frame</td>
      <td>True</td>
    </tr>
    <tr>
      <th>115</th>
      <td>Window Arched Top_basic</td>
      <td>Material Frame</td>
      <td>True</td>
    </tr>
    <tr>
      <th>165</th>
      <td>Skylight_Operable_WIN</td>
      <td>Glazing</td>
      <td>True</td>
    </tr>
    <tr>
      <th>166</th>
      <td>Skylight_Operable_WIN</td>
      <td>Glazing Material</td>
      <td>True</td>
    </tr>
    <tr>
      <th>172</th>
      <td>Skylight_Operable_WIN</td>
      <td>Mullion Height</td>
      <td>True</td>
    </tr>
    <tr>
      <th>184</th>
      <td>Skylight_Operable_WIN</td>
      <td>Window Blind Type</td>
      <td>True</td>
    </tr>
    <tr>
      <th>185</th>
      <td>Skylight_Operable_WIN</td>
      <td>Window Jockey Sash</td>
      <td>True</td>
    </tr>
    <tr>
      <th>186</th>
      <td>Skylight_Operable_WIN</td>
      <td>Window Louvre</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>




```python
not_legit_param.ParameterName.unique()
```




    array([u'Radius', u'Material Frame', u'Glazing', u'Glazing Material',
           u'Mullion Height', u'Window Blind Type', u'Window Jockey Sash',
           u'Window Louvre', u'Window Shade Centre', u'Window Shade Left',
           u'Window Shade Right', u'Window Shade Top', u'Windowframefinish',
           u'Windowframematerial', u'Windowframetype', u'Windowglazingtype',
           u'Windowheadheight', u'Windowoverallframeheight',
           u'Windowoverallframewidth', u'DAF_Revision number_t',
           u'WNF_Ext Frame_Offset_Internal Skin_i',
           u'WNF_Frame_Surround_Depth_t', u'WNF_Frame_Surround_Width_t',
           u'WNF_Overall Frame Height_t', u'WNF_Overall Frame Width_t',
           u'WNF_Panel_Main Fixed_Height_t', u'WNF_Panel_Main Fixed_Width_t',
           u'CreatedBy_ANZRS', u'CreatedByURL_ANZRS', u'Panel Height',
           u'WNP_Schedule Filter_Louvre_t', u'Bars', u'Panel Width',
           u'Door Undercut', u'Author', u'Copyright', u'Modified Issue',
           u'Length', u'Either Side Swing Away', u'Either Side Swing Towards',
           u'Front Swing Away', u'Front Swing Towards',
           u'Hinge Side Swing Away', u'Hinge Side Swing Towards',
           u'Latch Side Swing Away', u'Latch Side Swing Towards',
           u'Material Door Panel', u'Material Door Panel EXT',
           u'Material Door Panel INT', u'Acoustic Performance', u'FF&E Code',
           u'FF&E Comments', u'FF&E Description', u'FF&E Issue', u'FF&E Item',
           u'FF&E Supplier', u'ItemCode', u'ItemDescription', u'ItemGroup',
           u'Grade', u'Mass per m', u'Column Length', u'ModifiedIssue',
           u'DAF_Created By_Username_t', u'DAF_Modified By_Username_t',
           u'DAF_Modified_Date_t', u'DAF_Owned By_t', u'No. of Parks',
           u'AS1428 Tolerance', u'Clear Opening', u'Double Rebate',
           u'Double Swing', u'Frame Overlaps Wall',
           u'Frame to Match Wall Thickness', u'Leaf 1 Width', u'Leaf Height',
           u'Material View Panel', u'Structural Opening',
           u'Structural Opening Height', u'View Panel', u'View Panel Height',
           u'View Panel Inset', u'View Panel Sill', u'View Panel Width',
           u'Leaf 2 Width', u'Door Thickness', u'Swing Angle', u'Bolt Latch',
           u'Closer', u'Core', u'Door Leaf Height', u'Door Leaf Thickness',
           u'Door Leaf Type', u'Door Seals', u'Door Stop', u'Electric Locking',
           u'Electromagnetic Hold Open', u'Fire/Smoke Door', u'Frame Profile',
           u'Head Details', u'Jamb Details', u'Lock/Latch',
           u'Meeting Stile Detail', u'Other Protection', u'Pull Handle',
           u'Pull Side Finish Zone', u'Push Plates', u'Push Side Finish Zone',
           u'Reed Switch', u'Revision', u'Roller Catch', u'Sill Details',
           u'Special Hardware', u'Benchtop Material', u'Handle Height',
           u'Room Name', u'STF_Parking_BayAngle_t',
           u'STF_Parking_Stripe_End_i', u'STF_Parking_Wheelstop_Position_t',
           u'STF_Parking_Wheelstop_YesNo_t', u'STF_ParkingBay_Depth_t',
           u'STF_ParkingBay_Width_t', u'FF&E Group', u'Base Price', u'Catalog',
           u'Catalog Code', u'Package Qty', u'Product Documentation Link',
           u'Watermarked By', u'_SPEC_WILKHAHN_ANSI/BIFMA_STANDARDS',
           u'_SPEC_WILKHAHN_DIN_EN_STANDARDS',
           u'_SPEC_WILKHAHN_FURNTECH-AFRDI_BLUE_TICK',
           u'_SPEC_WILKHAHN_FURNTECH-AFRDI_GREEN_TICK',
           u'_SPEC_WILKHAHN_GS_SYMBOL', u'_SPEC_WILKHAHN_Model',
           u'_SPEC_WILKHAHN_NPR_STANDARDS', u'_SPEC_WILKHAHN_Part_Number',
           u'_SPEC_WILKHAHN_Table_Length', u'_SPEC_WILKHAHN_Table_Width',
           u'_SPEC_WILKHAHN_URL', u'_SPEC_WILKHAHN_Version',
           u'_WILKHAHN Table Height', u'_WILKHAHN Table Length',
           u'_WILKHAHN Table Width', u'CheckedBy_ANZRS', u'Base Finish',
           u'Frame Finish', u'Armpad Finish', u'Seat/Back Fabric',
           u'Y-Tower Finish', u'Back Finish', u'Carcass Material',
           u'Door Panel Height', u'Handle Offset', u'Door Panel Thickness',
           u'Door Grille/Undercut', u'Door Leaf Width',
           u'Protection on Pull Side', u'Protection on Push Side',
           u'Small Panel Width', u'Area_Colour_Bvn', u'Bench_Material_Bvn',
           u'Bench_Thickness_Bvn', u'Benchtopfinish', u'Benchtopmaterial',
           u'Benchtopthickness', u'Carcasefinish', u'Carcasematerial',
           u'Carcass_Material_Bvn', u'Carcess_Thickness_Bvn',
           u'Caseworkoveralldepth', u'Caseworkoverallheight',
           u'Caseworkoverallwidth', u'Cb Classification', u'Cb Code 1',
           u'Cb Description', u'Cb Group', u'Cdeb_Doorid', u'Cdeb_Rminstid',
           u'Cdeb_Status', u'Ceiling_Height_Bvn', u'Cf_1', u'Cf_2',
           u'Department_BVN', u'Depth_Bvn', u'Depth_Two_Bvn',
           u'Detailedcategory', u'Ff_1', u'Ff_2', u'FF_SPECIFIC_1',
           u'Frontpanel_Left_Material_Bvn', u'Frontpanel_Right_Material_Bvn',
           u'Frontpanel_Single_Material_Bvn', u'Generic Room Sheet Reference',
           u'Height_Bvn', u'Height_Skirting_Bvn', u'Height_Two_Bvn',
           u'Hfbs_Sub_Department', u'Kicker Material', u'Kickerfinish',
           u'Kickerheight', u'Kickermaterial', u'Link_Status',
           u'Mounted_Top_Bvn', u'Mounting_Height_Bvn',
           u'Mounting_Height_Centre_Bvn', u'Mounting_Height_Top_Bvn',
           u'Overall_Height_Bvn', u'rwcalc_Panel Offset off Base',
           u'Sp_Area_Designed', u'Sp_Ceiling_Height', u'Sp_Circulation_Area',
           u'Sp_Comments', u'Sp_Department', u'Sp_Depth', u'Sp_Gfa_Factor',
           u'Sp_Material_Ceilings', u'Sp_Material_Walls', u'Sp_Net_Area',
           u'Sp_Per_Unit_Area', u'Sp_Room_Name', u'Sp_Room_Number',
           u'Sp_Total_Gfa_Area', u'Sp_Unique_Id', u'Sp_Units', u'Sp_Width',
           u'Sub-Department', u'Thickness_Shelf', u'Wf_E_1', u'Wf_E_2',
           u'Wf_N_1', u'Wf_N_2', u'Wf_S_1', u'Wf_S_2', u'Wf_W_1', u'Wf_W_2',
           u'Width_Bvn', u'Width_Corner_Bvn', u'Width_Counter_Dda_Bvn',
           u'Width_Two_Bvn', u'Carcase Offset off Wall',
           u'End Panel Side I Finish', u'End Panel Side II Finish',
           u'Front Panel Finish', u'rwcalc_Front Panel Visibility',
           u'rwcalc_Kickplate On', u'rwcalc_Kickplate Side I setback',
           u'rwcalc_Kickplate Side II setback', u'rwcalc_Kickplate Visibility',
           u'rwcalc_Panel Back Offset', u'rwcalc_Panel Inset Side I',
           u'rwcalc_Panel Inset Side II', u'rwcalc_Panel Thk Base',
           u'rwcalc_Panel Thk Side I', u'rwcalc_Panel Thk Side II',
           u'rwcalc_Panel Thk Top', u'rwcalc_Real Panel Base Thk',
           u'rwcalc_Real Panel Side I Thk', u'rwcalc_Real Panel Side II Thk',
           u'rwcalc_Real Panel Top Thk', u'rwcalc_Single Panel Width',
           u'rwcalc_Swappable', u'Side I Divider Panel', u'Side I End Panel',
           u'Side I End Panel Extend Back', u'Side I Kickplate Flush',
           u'Side I Shadow Margin', u'Side II Divider Panel',
           u'Side II End Panel', u'Side II End Panel Extend Back',
           u'Side II Kickplate Flush', u'Side II Shadow Margin',
           u'rwcalc_Carcase Inside Width', u'rwcalc_Cupboard1 Height',
           u'rwcalc_Double Panel Width', u'rwcalc_Shelf Depth',
           u'rwcalc_Shelf1', u'rwcalc_Shelf2', u'rwcalc_Shelf3',
           u'rwcalc_Shelf4', u'rwcalc_Shelf5', u'rwcalc_Shelf6',
           u'rwcalc_Show Double Front Panel',
           u'rwcalc_Show Single Front Panel', u'rwcalc_Symbolic Depth',
           u'rwcalc_Shelf2 Height', u'rwcalc_Shelf3 Height',
           u'rwcalc_Shelf4 Height', u'rwcalc_Shelf5 Height',
           u'rwcalc_Shelf6 Height', u'rwcalc_Rail Offset', u'rwcalc_Rail1',
           u'rwcalc_Rail2', u'MOUNTING_HEIGHT_US_BVN', u'Asset Number',
           u'Briefed Area', u'Building Name', u'Grid Prefix', u'Project',
           u'Room Code', u'Stage', u'Zone'], dtype=object)



## No. of SP parameters vs non-BVN SP parameters of each family


```python
check_for_sp = nameAndSp.groupby(["FamilyName", "BVNparam"]).agg(["count"])

check_for_sp.head()
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>ParameterName</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>count</th>
    </tr>
    <tr>
      <th>FamilyName</th>
      <th>BVNparam</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">1 Bay Window</th>
      <th>False</th>
      <td>33</td>
    </tr>
    <tr>
      <th>True</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1 Bay Window - Non Hosted</th>
      <th>False</th>
      <td>30</td>
    </tr>
    <tr>
      <th>10P_Perimeter_Bench_FYS</th>
      <th>False</th>
      <td>17</td>
    </tr>
    <tr>
      <th>115_BVNDH_WC Cubicle</th>
      <th>False</th>
      <td>25</td>
    </tr>
  </tbody>
</table>
</div>



## Filters shared parameters that aren't being used in the Master Content (*dead shared parameters*)


```python
test = p_BVN.isin(nameAndSp["ParameterName"])
```


    ---------------------------------------------------------------------------

    AttributeError                            Traceback (most recent call last)

    <ipython-input-120-8b70e06d2d71> in <module>()
    ----> 1 test = p_BVN.isin(nameAndSp["ParameterName"])
    

    AttributeError: 'list' object has no attribute 'isin'



```python
dead_params = ~nameAndSp["ParameterName"].isin(p_BVN)

dead_params
```




    0          True
    1          True
    2          True
    3          True
    4          True
    5          True
    6          True
    7          True
    8          True
    9          True
    10         True
    11         True
    12         True
    13         True
    14         True
    15         True
    16         True
    17         True
    18         True
    19         True
    20         True
    21         True
    22         True
    23         True
    24         True
    25         True
    26         True
    27         True
    28         True
    29         True
              ...  
    132858    False
    132859    False
    132860    False
    132861    False
    132862    False
    132863    False
    132864    False
    132865    False
    132866    False
    132867    False
    132868    False
    132869     True
    132870    False
    132871    False
    132872    False
    132873    False
    132874    False
    132875    False
    132876    False
    132877    False
    132878    False
    132879    False
    132880    False
    132881    False
    132882     True
    132883    False
    132884    False
    132885    False
    132886    False
    132887    False
    Name: ParameterName, dtype: bool



# MATERIALS

**m_path** and **m** reads from the ParameterValuesByTypes excel file.


```python
m_path = os.path.join(directory, file_dict["Materials"])
m = pd.read_excel(m_path)

m["FamilyFilePath"] = m.apply(remove_rfaName, axis=1)
m["FamilyFilePath"] = m.apply(stripCommonPath, axis=1)
m["FamilyName"] = m.apply(stripFileType, axis=1)

m.drop(["ID", "MaterialColour", "Shininess", "Smoothness", "Transparency"], axis=1, inplace=True)

m.head(100)
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FamilyFilePath</th>
      <th>FamilyName</th>
      <th>Name</th>
      <th>CutPatternName</th>
      <th>CutPatternColour</th>
      <th>SurfacePatternName</th>
      <th>SurfacePatternColour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Default</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Default Roof</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Default Wall</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Glass</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Poche</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Windows\Structural</td>
      <td>Window_Square Opening_WIN</td>
      <td>Default Light Source</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Windows\Structural</td>
      <td>Window_Round Opening_WIN</td>
      <td>Default</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Windows\Structural</td>
      <td>Window_Round Opening_WIN</td>
      <td>Default Roof</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Windows\Structural</td>
      <td>Window_Round Opening_WIN</td>
      <td>Default Wall</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Windows\Structural</td>
      <td>Window_Round Opening_WIN</td>
      <td>Glass</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Windows\Structural</td>
      <td>Window_Round Opening_WIN</td>
      <td>Poche</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Windows\Structural</td>
      <td>Window_Round Opening_WIN</td>
      <td>Default Light Source</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Windows\Special</td>
      <td>Window Round_basic</td>
      <td>Default</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Windows\Special</td>
      <td>Window Round_basic</td>
      <td>Default Roof</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Windows\Special</td>
      <td>Window Round_basic</td>
      <td>Default Wall</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Windows\Special</td>
      <td>Window Round_basic</td>
      <td>Glass</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Windows\Special</td>
      <td>Window Round_basic</td>
      <td>Poche</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Windows\Special</td>
      <td>Window Round_basic</td>
      <td>Default Light Source</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Windows\Special</td>
      <td>Window Round_basic</td>
      <td>Aluminum</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Windows\Special</td>
      <td>Window Lancet_basic</td>
      <td>Default</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Windows\Special</td>
      <td>Window Lancet_basic</td>
      <td>Default Roof</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Windows\Special</td>
      <td>Window Lancet_basic</td>
      <td>Default Wall</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Windows\Special</td>
      <td>Window Lancet_basic</td>
      <td>Glass</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Windows\Special</td>
      <td>Window Lancet_basic</td>
      <td>Poche</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Windows\Special</td>
      <td>Window Lancet_basic</td>
      <td>Default Light Source</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Windows\Special</td>
      <td>Window Lancet_basic</td>
      <td>Aluminum</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Windows\Special</td>
      <td>Window Arched Top_basic</td>
      <td>Default</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Windows\Special</td>
      <td>Window Arched Top_basic</td>
      <td>Default Roof</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Windows\Special</td>
      <td>Window Arched Top_basic</td>
      <td>Default Wall</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Windows\Special</td>
      <td>Window Arched Top_basic</td>
      <td>Glass</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>70</th>
      <td>Windows\Special</td>
      <td>Hopper with Trim_WIN</td>
      <td>Sash</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>71</th>
      <td>Windows\Special</td>
      <td>Hopper with Trim_WIN</td>
      <td>Trim</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>72</th>
      <td>Windows\Special</td>
      <td>Hopper with Trim_WIN</td>
      <td>Default</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>73</th>
      <td>Windows\Special</td>
      <td>Hopper with Trim_WIN</td>
      <td>Default Roof</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>74</th>
      <td>Windows\Special</td>
      <td>Hopper with Trim_WIN</td>
      <td>Default Wall</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>75</th>
      <td>Windows\Special</td>
      <td>Hopper with Trim_WIN</td>
      <td>Poche</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>76</th>
      <td>Windows\Special</td>
      <td>Hopper with Trim_WIN</td>
      <td>Default Light Source</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>77</th>
      <td>Windows\Special</td>
      <td>Face Based Fixed Window for Angled Hosts</td>
      <td>Default</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>78</th>
      <td>Windows\Special</td>
      <td>Face Based Fixed Window for Angled Hosts</td>
      <td>Poche</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>79</th>
      <td>Windows\Special</td>
      <td>Face Based Fixed Window for Angled Hosts</td>
      <td>Analytical Floor Surface</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>80</th>
      <td>Windows\Special</td>
      <td>Face Based Fixed Window for Angled Hosts</td>
      <td>Analytical Slab Surface</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Windows\Special</td>
      <td>Face Based Fixed Window for Angled Hosts</td>
      <td>Analytical Wall Surface</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>82</th>
      <td>Windows\Special</td>
      <td>Face Based Fixed Window for Angled Hosts</td>
      <td>Default Wall</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Windows\Special</td>
      <td>Face Based Fixed Window for Angled Hosts</td>
      <td>Glass</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>84</th>
      <td>Windows\Special</td>
      <td>Face Based Fixed Window for Angled Hosts</td>
      <td>Phase-Demo</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>85</th>
      <td>Windows\Special</td>
      <td>Face Based Fixed Window for Angled Hosts</td>
      <td>Phase-Exist</td>
      <td>Solid fill</td>
      <td>Red[0]; Green[0]; Blue[0]</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>86</th>
      <td>Windows\Special</td>
      <td>Face Based Fixed Window for Angled Hosts</td>
      <td>Phase-Temp</td>
      <td>Diagonal up</td>
      <td>Red[0]; Green[0]; Blue[0]</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>87</th>
      <td>Windows\Special</td>
      <td>Face Based Fixed Window for Angled Hosts</td>
      <td>Default Light Source</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>88</th>
      <td>Windows\Special</td>
      <td>Face Based Fixed Window for Angled Hosts</td>
      <td>Phase - Demo</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>89</th>
      <td>Windows\Special</td>
      <td>Face Based Fixed Window for Angled Hosts</td>
      <td>Phase - Exist</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Windows\Special</td>
      <td>Face Based Fixed Window for Angled Hosts</td>
      <td>Phase - Temporary</td>
      <td>Diagonal up</td>
      <td>Red[0]; Green[0]; Blue[127]</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>91</th>
      <td>Windows\Special</td>
      <td>Face Based Fixed Window for Angled Hosts</td>
      <td>Default Roof</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>92</th>
      <td>Windows\Special</td>
      <td>Face Based Fixed Window for Angled Hosts</td>
      <td>Aluminum</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>93</th>
      <td>Windows\Special</td>
      <td>Ellipse with Trim_WIN</td>
      <td>Default</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>94</th>
      <td>Windows\Special</td>
      <td>Ellipse with Trim_WIN</td>
      <td>Default Roof</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>95</th>
      <td>Windows\Special</td>
      <td>Ellipse with Trim_WIN</td>
      <td>Default Wall</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>96</th>
      <td>Windows\Special</td>
      <td>Ellipse with Trim_WIN</td>
      <td>Glass</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>97</th>
      <td>Windows\Special</td>
      <td>Ellipse with Trim_WIN</td>
      <td>Wall Material (1)</td>
      <td>Diagonal crosshatch</td>
      <td>Red[0]; Green[0]; Blue[0]</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>98</th>
      <td>Windows\Special</td>
      <td>Ellipse with Trim_WIN</td>
      <td>Sash</td>
      <td>Diagonal crosshatch</td>
      <td>Red[0]; Green[0]; Blue[0]</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
    <tr>
      <th>99</th>
      <td>Windows\Special</td>
      <td>Ellipse with Trim_WIN</td>
      <td>Trim</td>
      <td>Diagonal crosshatch</td>
      <td>Red[0]; Green[0]; Blue[0]</td>
      <td>n/a</td>
      <td>n/a</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 7 columns</p>
</div>




```python
nameAndMat = m[["FamilyName", "Name"]]

nameAndMat.head()
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FamilyName</th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Window_Square Opening_WIN</td>
      <td>Default</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Window_Square Opening_WIN</td>
      <td>Default Roof</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Window_Square Opening_WIN</td>
      <td>Default Wall</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Window_Square Opening_WIN</td>
      <td>Glass</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Window_Square Opening_WIN</td>
      <td>Poche</td>
    </tr>
  </tbody>
</table>
</div>




```python
mat_grouped = nameAndMat.groupby("FamilyName").agg(["count"])

mat_grouped
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>Name</th>
    </tr>
    <tr>
      <th></th>
      <th>count</th>
    </tr>
    <tr>
      <th>FamilyName</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1 Bay Window</th>
      <td>11</td>
    </tr>
    <tr>
      <th>1 Bay Window - Non Hosted</th>
      <td>19</td>
    </tr>
    <tr>
      <th>10P_Perimeter_Bench_FYS</th>
      <td>22</td>
    </tr>
    <tr>
      <th>115_BVNDH_WC Cubicle</th>
      <td>12</td>
    </tr>
    <tr>
      <th>12P_Meeting_FYS</th>
      <td>28</td>
    </tr>
    <tr>
      <th>140 Block_DCO</th>
      <td>12</td>
    </tr>
    <tr>
      <th>14P_Meeting_Rectangle_FYS</th>
      <td>26</td>
    </tr>
    <tr>
      <th>16P_Meeting_Rectangle_ FYS</th>
      <td>26</td>
    </tr>
    <tr>
      <th>190 Block Section_DCO</th>
      <td>12</td>
    </tr>
    <tr>
      <th>190 Block_DCO</th>
      <td>12</td>
    </tr>
    <tr>
      <th>1_2 Step Surface_CPP</th>
      <td>9</td>
    </tr>
    <tr>
      <th>1_3 Step Surface_CPP</th>
      <td>9</td>
    </tr>
    <tr>
      <th>2 Bay Window</th>
      <td>11</td>
    </tr>
    <tr>
      <th>2 Bay Window - Corner</th>
      <td>18</td>
    </tr>
    <tr>
      <th>2 Bay Window - Non Hosted</th>
      <td>19</td>
    </tr>
    <tr>
      <th>2 persons</th>
      <td>45</td>
    </tr>
    <tr>
      <th>240L Bin_SEQ</th>
      <td>5</td>
    </tr>
    <tr>
      <th>2D Person - Plan (1)</th>
      <td>1</td>
    </tr>
    <tr>
      <th>2p_Casual_Seating_FYS</th>
      <td>18</td>
    </tr>
    <tr>
      <th>2p_Casual_Seating_Opt2_FYS</th>
      <td>18</td>
    </tr>
    <tr>
      <th>2p_Casual_Seating_Small_Chairs_FYS</th>
      <td>18</td>
    </tr>
    <tr>
      <th>3 Bay Window</th>
      <td>19</td>
    </tr>
    <tr>
      <th>3 Bay Window - Non Hosted</th>
      <td>19</td>
    </tr>
    <tr>
      <th>3 Phase Socket Outlet_EEQ</th>
      <td>6</td>
    </tr>
    <tr>
      <th>3 Way Valve_20_100 mm_PLU</th>
      <td>6</td>
    </tr>
    <tr>
      <th>3p_Casual_Seating_FYS</th>
      <td>57</td>
    </tr>
    <tr>
      <th>4 Bay Window</th>
      <td>18</td>
    </tr>
    <tr>
      <th>4 Bay Window - Non Hosted</th>
      <td>19</td>
    </tr>
    <tr>
      <th>40PP_Rows_FYS</th>
      <td>26</td>
    </tr>
    <tr>
      <th>45 Glass Partition Between Offices_DCO</th>
      <td>9</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>Workstation_Parametric_FUR</th>
      <td>10</td>
    </tr>
    <tr>
      <th>Workstation_Quiet_4 person Setting_FYS</th>
      <td>30</td>
    </tr>
    <tr>
      <th>Workstation_Single_Desk_1800l_Setup_FYS</th>
      <td>15</td>
    </tr>
    <tr>
      <th>Workstation_Single_Desk_Setup_FUR</th>
      <td>15</td>
    </tr>
    <tr>
      <th>Workstation_Single_Desk_Small_FUR</th>
      <td>15</td>
    </tr>
    <tr>
      <th>Workstation_ZenithRumba _Set 10A_FYS</th>
      <td>36</td>
    </tr>
    <tr>
      <th>Workstation_ZenithRumba _Set 10B_FYS</th>
      <td>23</td>
    </tr>
    <tr>
      <th>Workstation_ZenithRumba _Set 2_FYS</th>
      <td>22</td>
    </tr>
    <tr>
      <th>Workstation_ZenithRumba _Set 4A_FYS</th>
      <td>36</td>
    </tr>
    <tr>
      <th>Workstation_ZenithRumba _Set 4B_FYS</th>
      <td>23</td>
    </tr>
    <tr>
      <th>Workstation_ZenithRumba _Set 4C_FYS</th>
      <td>40</td>
    </tr>
    <tr>
      <th>Workstation_ZenithRumba _Set 4D_FYS</th>
      <td>24</td>
    </tr>
    <tr>
      <th>Workstation_ZenithRumba _Set 5_FYS</th>
      <td>36</td>
    </tr>
    <tr>
      <th>Workstation_ZenithRumba _Set 6_FYS</th>
      <td>36</td>
    </tr>
    <tr>
      <th>Workstation_ZenithRumba _Set 8_FYS</th>
      <td>23</td>
    </tr>
    <tr>
      <th>Wye True_Flanged_CS_PN 16_PLU</th>
      <td>6</td>
    </tr>
    <tr>
      <th>Wye True_Flanged_CS_PN 25_PLU</th>
      <td>6</td>
    </tr>
    <tr>
      <th>Wye True_Flanged_CS_PN 40_PLU</th>
      <td>6</td>
    </tr>
    <tr>
      <th>X_Pedestal Castors_FUR</th>
      <td>11</td>
    </tr>
    <tr>
      <th>X_Swing_Frameless_CUR</th>
      <td>14</td>
    </tr>
    <tr>
      <th>Y_Flanged_DI_PN 10_PLU</th>
      <td>6</td>
    </tr>
    <tr>
      <th>Y_Flanged_DI_PN 16_PLU</th>
      <td>6</td>
    </tr>
    <tr>
      <th>Y_Flanged_DI_PN 25_PLU</th>
      <td>6</td>
    </tr>
    <tr>
      <th>Y_Flanged_DI_PN 40_PLU</th>
      <td>6</td>
    </tr>
    <tr>
      <th>Yacht_ENT</th>
      <td>7</td>
    </tr>
    <tr>
      <th>Z Flashing_DCO</th>
      <td>12</td>
    </tr>
    <tr>
      <th>Z Purlin Girt_DCO</th>
      <td>8</td>
    </tr>
    <tr>
      <th>Z Purlin Girt_Framing_STB</th>
      <td>11</td>
    </tr>
    <tr>
      <th>Zig Zag Surface_CPP</th>
      <td>9</td>
    </tr>
    <tr>
      <th>Zip Hydrotap_MEQ</th>
      <td>12</td>
    </tr>
  </tbody>
</table>
<p>5198 rows × 1 columns</p>
</div>




```python
mat_counts = mat_grouped["Name"]
mat_counts[mat_counts["count"]>100]
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
    </tr>
    <tr>
      <th>FamilyName</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Drainage_Roof Drain 100mm_DCO</th>
      <td>278</td>
    </tr>
    <tr>
      <th>Drainage_Roof Drain 150mm_DCO</th>
      <td>278</td>
    </tr>
    <tr>
      <th>Drainage_Roof Drain 200mm_DCO</th>
      <td>278</td>
    </tr>
    <tr>
      <th>Drainage_Roof Drain_DCO</th>
      <td>278</td>
    </tr>
    <tr>
      <th>Dulux_ Colour Family_Blues_GEN</th>
      <td>1144</td>
    </tr>
    <tr>
      <th>Dulux_ Colour Family_Bolds and Brights_GEN</th>
      <td>144</td>
    </tr>
    <tr>
      <th>Dulux_ Colour Family_Greens_GEN</th>
      <td>968</td>
    </tr>
    <tr>
      <th>Dulux_ Colour Family_New Zealand_GEN</th>
      <td>120</td>
    </tr>
    <tr>
      <th>Dulux_ Colour Family_Oranges_GEN</th>
      <td>264</td>
    </tr>
    <tr>
      <th>Dulux_ Colour Family_Pastels and Near Whites_GEN</th>
      <td>143</td>
    </tr>
    <tr>
      <th>Dulux_ Colour Family_Purples_GEN</th>
      <td>792</td>
    </tr>
    <tr>
      <th>Dulux_ Colour Family_Reds and Pinks_GEN</th>
      <td>351</td>
    </tr>
    <tr>
      <th>Dulux_ Colour Family_Soft and Chromatic Greys_GEN</th>
      <td>144</td>
    </tr>
    <tr>
      <th>Dulux_ Colour Family_Whites and Neutrals_GEN</th>
      <td>143</td>
    </tr>
    <tr>
      <th>Dulux_ Colour Family_Yellows_GEN</th>
      <td>703</td>
    </tr>
    <tr>
      <th>Sprinkler_Dry_Horizontal Sidewall_Fully Recessed_Hosted_PLU</th>
      <td>104</td>
    </tr>
    <tr>
      <th>Sprinkler_Dry_Horizontal Sidewall_Hosted_PLU</th>
      <td>104</td>
    </tr>
    <tr>
      <th>Sprinkler_Dry_Horizontal Sidewall_Semi_Recessed_Hosted_PLU</th>
      <td>104</td>
    </tr>
    <tr>
      <th>Sprinkler_Horizontal Sidewall_Fully Recessed_Hosted_PLU</th>
      <td>104</td>
    </tr>
    <tr>
      <th>Sprinkler_Horizontal Sidewall_Hosted_PLU</th>
      <td>104</td>
    </tr>
    <tr>
      <th>Sprinkler_Horizontal Sidewall_PLU</th>
      <td>104</td>
    </tr>
    <tr>
      <th>Sprinkler_Horizontal Sidewall_Semi_Recessed_Hosted_PLU</th>
      <td>104</td>
    </tr>
    <tr>
      <th>Sprinkler_Pendant_Fully Recessed_Hosted_PLU</th>
      <td>104</td>
    </tr>
    <tr>
      <th>Sprinkler_Pendant_Hosted_PLU</th>
      <td>104</td>
    </tr>
    <tr>
      <th>Sprinkler_Pendant_PLU</th>
      <td>104</td>
    </tr>
    <tr>
      <th>Sprinkler_Pendant_Semi_Recessed_Hosted_PLU</th>
      <td>104</td>
    </tr>
    <tr>
      <th>Sprinkler_Symbol_Horizontal Sidewall_ANN</th>
      <td>104</td>
    </tr>
    <tr>
      <th>Sprinkler_Symbol_Outside_ANN</th>
      <td>104</td>
    </tr>
    <tr>
      <th>Sprinkler_Symbol_Pendant on Drop with Guard_ANN</th>
      <td>104</td>
    </tr>
    <tr>
      <th>Sprinkler_Symbol_Pendant on Drop_ANN</th>
      <td>104</td>
    </tr>
    <tr>
      <th>Sprinkler_Symbol_Pendant with Guard_ANN</th>
      <td>104</td>
    </tr>
    <tr>
      <th>Sprinkler_Symbol_Pendant_ANN</th>
      <td>104</td>
    </tr>
    <tr>
      <th>Sprinkler_Symbol_Upright on Sprig with Guard_ANN</th>
      <td>104</td>
    </tr>
    <tr>
      <th>Sprinkler_Symbol_Upright on Sprig_ANN</th>
      <td>104</td>
    </tr>
    <tr>
      <th>Sprinkler_Symbol_Upright with Guard_ANN</th>
      <td>104</td>
    </tr>
    <tr>
      <th>Sprinkler_Symbol_Upright_ANN</th>
      <td>104</td>
    </tr>
    <tr>
      <th>Sprinkler_Symbol_Window_ANN</th>
      <td>104</td>
    </tr>
    <tr>
      <th>Sprinkler_Tank_PLU</th>
      <td>170</td>
    </tr>
    <tr>
      <th>Sprinkler_Upright_PLU</th>
      <td>104</td>
    </tr>
    <tr>
      <th>Sprinkler_Window_Hosted_PLU</th>
      <td>104</td>
    </tr>
  </tbody>
</table>
</div>



## No. of unique materials


```python
print len(nameAndMat.Name.unique())
```

    6944
    


```python
mat_grouped["Name"].hist(bins=50);
plt.title("Number of materials embedded within family material library", fontsize=20)
plt.xlabel("Number of materials", fontsize=15)
plt.ylabel("Number of families", fontsize=15)
plt.show()
```


![png]({{site.baseurl}}/assets/first/output_125_0.png)



```python

```
